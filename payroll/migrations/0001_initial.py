# Generated by Django 4.2.23 on 2025-08-28 07:26

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('accounting', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('core', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='Employee',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('employee_code', models.CharField(max_length=20)),
                ('document_type', models.CharField(choices=[('CC', 'Cédula de Ciudadanía'), ('CE', 'Cédula de Extranjería'), ('TI', 'Tarjeta de Identidad'), ('PP', 'Pasaporte'), ('NIT', 'NIT')], max_length=3)),
                ('document_number', models.CharField(max_length=20)),
                ('first_name', models.CharField(max_length=100)),
                ('last_name', models.CharField(max_length=100)),
                ('birth_date', models.DateField()),
                ('gender', models.CharField(choices=[('M', 'Masculino'), ('F', 'Femenino'), ('O', 'Otro')], max_length=1)),
                ('marital_status', models.CharField(choices=[('single', 'Soltero(a)'), ('married', 'Casado(a)'), ('divorced', 'Divorciado(a)'), ('widowed', 'Viudo(a)'), ('union', 'Unión Libre')], max_length=20)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('phone', models.CharField(blank=True, max_length=20)),
                ('mobile', models.CharField(blank=True, max_length=20)),
                ('address', models.TextField()),
                ('city', models.CharField(max_length=100)),
                ('state', models.CharField(max_length=100)),
                ('hire_date', models.DateField()),
                ('termination_date', models.DateField(blank=True, null=True)),
                ('contract_type', models.CharField(choices=[('indefinite', 'Término Indefinido'), ('fixed', 'Término Fijo'), ('labor', 'Obra o Labor'), ('apprentice', 'Aprendizaje'), ('internship', 'Práctica'), ('services', 'Prestación de Servicios')], max_length=20)),
                ('position', models.CharField(max_length=200)),
                ('department', models.CharField(blank=True, max_length=100)),
                ('salary_type', models.CharField(choices=[('fixed', 'Salario Fijo'), ('variable', 'Salario Variable'), ('integral', 'Salario Integral')], max_length=20)),
                ('basic_salary', models.DecimalField(decimal_places=2, max_digits=15)),
                ('transportation_allowance', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('other_fixed_income', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('eps_code', models.CharField(blank=True, help_text='Código EPS', max_length=10)),
                ('eps_name', models.CharField(blank=True, help_text='Nombre EPS', max_length=200)),
                ('pension_fund_code', models.CharField(blank=True, help_text='Código Fondo de Pensiones', max_length=10)),
                ('pension_fund_name', models.CharField(blank=True, help_text='Nombre Fondo de Pensiones', max_length=200)),
                ('arl_code', models.CharField(blank=True, help_text='Código ARL', max_length=10)),
                ('arl_name', models.CharField(blank=True, help_text='Nombre ARL', max_length=200)),
                ('ccf_code', models.CharField(blank=True, help_text='Código CCF', max_length=10)),
                ('ccf_name', models.CharField(blank=True, help_text='Nombre CCF', max_length=200)),
                ('bank_account', models.CharField(blank=True, max_length=50)),
                ('bank_name', models.CharField(blank=True, max_length=200)),
                ('account_type', models.CharField(blank=True, choices=[('savings', 'Ahorros'), ('checking', 'Corriente')], max_length=20)),
                ('status', models.CharField(choices=[('active', 'Activo'), ('inactive', 'Inactivo'), ('vacation', 'Vacaciones'), ('medical_leave', 'Incapacidad'), ('maternity_leave', 'Licencia de Maternidad'), ('suspended', 'Suspendido'), ('terminated', 'Retirado')], default='active', max_length=20)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='employees', to='core.company')),
                ('cost_center', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='accounting.costcenter')),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Empleado',
                'verbose_name_plural': 'Empleados',
                'db_table': 'payroll_employees',
                'ordering': ['employee_code'],
            },
        ),
        migrations.CreateModel(
            name='PayrollConcept',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=10)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('concept_type', models.CharField(choices=[('earning', 'Devengo'), ('deduction', 'Deducción'), ('employer_contribution', 'Aporte Patronal'), ('provision', 'Provisión')], max_length=30)),
                ('calculation_type', models.CharField(choices=[('fixed', 'Valor Fijo'), ('percentage', 'Porcentaje'), ('formula', 'Fórmula'), ('days', 'Por Días'), ('hours', 'Por Horas')], max_length=20)),
                ('percentage', models.DecimalField(decimal_places=4, default=0, help_text='Porcentaje para cálculo', max_digits=8)),
                ('fixed_value', models.DecimalField(decimal_places=2, default=0, help_text='Valor fijo', max_digits=15)),
                ('formula', models.TextField(blank=True, help_text='Fórmula de cálculo')),
                ('affects_social_security', models.BooleanField(default=False)),
                ('affects_parafiscals', models.BooleanField(default=False)),
                ('affects_labor_benefits', models.BooleanField(default=False)),
                ('affects_income_tax', models.BooleanField(default=False)),
                ('show_in_payslip', models.BooleanField(default=True)),
                ('show_in_certificate', models.BooleanField(default=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('account', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='accounting.account')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payroll_concepts', to='core.company')),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Concepto de Nómina',
                'verbose_name_plural': 'Conceptos de Nómina',
                'db_table': 'payroll_concepts',
                'ordering': ['concept_type', 'code'],
                'unique_together': {('company', 'code')},
            },
        ),
        migrations.CreateModel(
            name='PayrollPeriod',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=100)),
                ('period_type', models.CharField(choices=[('biweekly', 'Quincenal'), ('monthly', 'Mensual'), ('weekly', 'Semanal'), ('daily', 'Diario')], max_length=20)),
                ('start_date', models.DateField()),
                ('end_date', models.DateField()),
                ('payment_date', models.DateField()),
                ('status', models.CharField(choices=[('open', 'Abierto'), ('calculated', 'Calculado'), ('approved', 'Aprobado'), ('paid', 'Pagado'), ('closed', 'Cerrado')], default='open', max_length=20)),
                ('calculated_at', models.DateTimeField(blank=True, null=True)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('total_earnings', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('total_deductions', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('total_employer_contributions', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('total_net_pay', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='payroll_periods_approved', to=settings.AUTH_USER_MODEL)),
                ('calculated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='payroll_periods_calculated', to=settings.AUTH_USER_MODEL)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payroll_periods', to='core.company')),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Período de Nómina',
                'verbose_name_plural': 'Períodos de Nómina',
                'db_table': 'payroll_periods',
                'ordering': ['-start_date'],
                'unique_together': {('company', 'name')},
            },
        ),
        migrations.CreateModel(
            name='Payroll',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('days_worked', models.IntegerField(default=30)),
                ('hours_worked', models.DecimalField(decimal_places=2, default=0, max_digits=8)),
                ('overtime_hours', models.DecimalField(decimal_places=2, default=0, max_digits=8)),
                ('total_earnings', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('total_deductions', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('total_employer_contributions', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('net_pay', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('status', models.CharField(choices=[('draft', 'Borrador'), ('calculated', 'Calculado'), ('approved', 'Aprobado'), ('paid', 'Pagado')], default='draft', max_length=20)),
                ('calculated_at', models.DateTimeField(blank=True, null=True)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='payrolls_approved', to=settings.AUTH_USER_MODEL)),
                ('calculated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='payrolls_calculated', to=settings.AUTH_USER_MODEL)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.company')),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payrolls', to='payroll.employee')),
                ('payroll_period', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payrolls', to='payroll.payrollperiod')),
            ],
            options={
                'verbose_name': 'Nómina',
                'verbose_name_plural': 'Nóminas',
                'db_table': 'payroll_payrolls',
                'ordering': ['employee__employee_code'],
                'unique_together': {('payroll_period', 'employee')},
            },
        ),
        migrations.CreateModel(
            name='LaborBenefit',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('benefit_type', models.CharField(choices=[('severance', 'Cesantías'), ('severance_interest', 'Intereses sobre Cesantías'), ('bonus', 'Prima de Servicios'), ('vacation', 'Vacaciones')], max_length=30)),
                ('period_start', models.DateField()),
                ('period_end', models.DateField()),
                ('base_salary', models.DecimalField(decimal_places=2, max_digits=15)),
                ('days', models.IntegerField()),
                ('amount', models.DecimalField(decimal_places=2, max_digits=15)),
                ('status', models.CharField(choices=[('accrued', 'Causado'), ('paid', 'Pagado'), ('compensated', 'Compensado')], default='accrued', max_length=20)),
                ('payment_date', models.DateField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.company')),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='labor_benefits', to='payroll.employee')),
            ],
            options={
                'verbose_name': 'Prestación Social',
                'verbose_name_plural': 'Prestaciones Sociales',
                'db_table': 'payroll_labor_benefits',
                'ordering': ['-period_end'],
            },
        ),
        migrations.CreateModel(
            name='EmployeeType',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('code', models.CharField(max_length=10)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True)),
                ('applies_social_security', models.BooleanField(default=True, help_text='Aplica seguridad social')),
                ('applies_parafiscals', models.BooleanField(default=True, help_text='Aplica parafiscales')),
                ('applies_labor_benefits', models.BooleanField(default=True, help_text='Aplica prestaciones sociales')),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='employee_types', to='core.company')),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Tipo de Empleado',
                'verbose_name_plural': 'Tipos de Empleado',
                'db_table': 'payroll_employee_types',
                'unique_together': {('company', 'code')},
            },
        ),
        migrations.AddField(
            model_name='employee',
            name='employee_type',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='payroll.employeetype'),
        ),
        migrations.CreateModel(
            name='PayrollDetail',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('quantity', models.DecimalField(decimal_places=2, default=1, max_digits=8)),
                ('rate', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=15)),
                ('description', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('concept', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='payroll.payrollconcept')),
                ('payroll', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='details', to='payroll.payroll')),
            ],
            options={
                'verbose_name': 'Detalle de Nómina',
                'verbose_name_plural': 'Detalles de Nómina',
                'db_table': 'payroll_details',
                'unique_together': {('payroll', 'concept')},
            },
        ),
        migrations.AlterUniqueTogether(
            name='employee',
            unique_together={('company', 'employee_code')},
        ),
    ]
