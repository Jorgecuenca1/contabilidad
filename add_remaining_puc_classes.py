#!/usr/bin/env python
"""
Script para agregar las clases restantes del PUC (4-9):
- Clase 4: INGRESOS
- Clase 5: GASTOS 
- Clase 6: COSTOS
- Clase 7: COSTOS DE PRODUCCIÓN
- Clase 8: CUENTAS DE ORDEN DEUDORAS
- Clase 9: CUENTAS DE ORDEN ACREEDORAS
"""
import os
import sys
import django

# Setup Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'contabilidad_multiempresa.settings')
django.setup()

from core.models import Company, User
from accounting.models import ChartOfAccounts, AccountType, Account

def add_remaining_puc_classes():
    """Agregar las clases 4-9 del PUC a todas las empresas."""
    companies = Company.objects.all()
    admin_user = User.objects.filter(is_superuser=True).first()
    
    if not admin_user:
        print("[ERROR] No se encontro usuario administrador.")
        return
    
    # Obtener tipos de cuenta
    account_types = {}
    for at in AccountType.objects.all():
        account_types[at.code] = at
    
    # CLASE 4 - INGRESOS
    ingresos_accounts = [
        ('4', 'INGRESOS', None, False),
        ('41', 'OPERACIONALES', '4', False),
        ('4105', 'AGRICULTURA GANADERIA CAZA Y SILVICULTURA', '41', False),
        ('410505', 'Actividad agrícola', '4105', True),
        ('410510', 'Actividad ganadera', '4105', True),
        ('410515', 'Actividad avícola', '4105', True),
        ('410520', 'Actividad porcícola', '4105', True),
        ('410525', 'Actividad apícola', '4105', True),
        ('410530', 'Actividad piscícola', '4105', True),
        ('410535', 'Actividad de caza', '4105', True),
        ('410540', 'Actividad de silvicultura', '4105', True),
        ('4110', 'PESCA', '41', False),
        ('411005', 'Pesca marítima', '4110', True),
        ('411010', 'Pesca fluvial', '4110', True),
        ('411015', 'Pesca lacustre', '4110', True),
        ('4115', 'EXPLOTACIÓN DE MINAS Y CANTERAS', '41', False),
        ('411505', 'Carbón', '4115', True),
        ('411510', 'Petróleo crudo', '4115', True),
        ('411515', 'Gas natural', '4115', True),
        ('411520', 'Minerales metálicos', '4115', True),
        ('411525', 'Minerales no metálicos', '4115', True),
        ('411530', 'Minerales de sal', '4115', True),
        ('411595', 'Otros', '4115', True),
        ('4120', 'INDUSTRIAS MANUFACTURERAS', '41', False),
        ('412001', 'Alimentos', '4120', True),
        ('412002', 'Bebidas', '4120', True),
        ('412003', 'Productos de tabaco', '4120', True),
        ('412004', 'Productos textiles', '4120', True),
        ('412005', 'Prendas de vestir', '4120', True),
        ('412006', 'Cuero y productos conexos', '4120', True),
        ('412007', 'Madera y productos de madera', '4120', True),
        ('412008', 'Papel cartón y productos de papel', '4120', True),
        ('412009', 'Actividades de impresión', '4120', True),
        ('412010', 'Productos químicos', '4120', True),
        ('412011', 'Productos farmacéuticos', '4120', True),
        ('412012', 'Productos de caucho y plástico', '4120', True),
        ('412013', 'Productos minerales no metálicos', '4120', True),
        ('412014', 'Productos metalúrgicos básicos', '4120', True),
        ('412015', 'Productos metálicos', '4120', True),
        ('412016', 'Productos informáticos electrónicos', '4120', True),
        ('412017', 'Aparatos eléctricos', '4120', True),
        ('412018', 'Maquinaria y equipo', '4120', True),
        ('412019', 'Vehículos automotores', '4120', True),
        ('412020', 'Otros tipos de transporte', '4120', True),
        ('412021', 'Muebles', '4120', True),
        ('412095', 'Otros', '4120', True),
        ('4125', 'SUMINISTRO DE ELECTRICIDAD GAS VAPOR Y AIRE ACONDICIONADO', '41', False),
        ('412505', 'Energía eléctrica', '4125', True),
        ('412510', 'Gas por tubería', '4125', True),
        ('412515', 'Vapor y aire acondicionado', '4125', True),
        ('4130', 'DISTRIBUCIÓN DE AGUA EVACUACIÓN DE AGUAS RESIDUALES', '41', False),
        ('413005', 'Distribución de agua', '4130', True),
        ('413010', 'Evacuación de aguas residuales', '4130', True),
        ('413015', 'Gestión de desechos', '4130', True),
        ('4135', 'CONSTRUCCIÓN', '41', False),
        ('413505', 'Construcción de edificios', '4135', True),
        ('413510', 'Construcción de carreteras y vías de ferrocarril', '4135', True),
        ('413515', 'Construcción de proyectos de servicio público', '4135', True),
        ('413520', 'Construcción de otras obras de ingeniería civil', '4135', True),
        ('413525', 'Demolición y preparación del terreno', '4135', True),
        ('413530', 'Instalaciones eléctricas de fontanería', '4135', True),
        ('413535', 'Terminación y acabado de edificios', '4135', True),
        ('413595', 'Otras actividades especializadas para la construcción', '4135', True),
        ('4140', 'COMERCIO AL POR MAYOR Y AL POR MENOR', '41', False),
        ('414005', 'Venta de vehículos automotores', '4140', True),
        ('414010', 'Mantenimiento y reparación de vehículos automotores', '4140', True),
        ('414015', 'Venta de partes piezas y accesorios', '4140', True),
        ('414020', 'Comercio al por mayor', '4140', True),
        ('414025', 'Comercio al por menor', '4140', True),
        ('4145', 'TRANSPORTE Y ALMACENAMIENTO', '41', False),
        ('414505', 'Transporte terrestre', '4145', True),
        ('414510', 'Transporte marítimo y por vías navegables', '4145', True),
        ('414515', 'Transporte aéreo', '4145', True),
        ('414520', 'Almacenamiento y actividades complementarias al transporte', '4145', True),
        ('414525', 'Correo y servicios de mensajería', '4145', True),
        ('4150', 'ALOJAMIENTO Y SERVICIOS DE COMIDA', '41', False),
        ('415005', 'Actividades de alojamiento', '4150', True),
        ('415010', 'Actividades de servicios de comidas y bebidas', '4150', True),
        ('4155', 'INFORMACIÓN Y COMUNICACIONES', '41', False),
        ('415505', 'Actividades de edición', '4155', True),
        ('415510', 'Actividades cinematográficas de vídeo', '4155', True),
        ('415515', 'Actividades de radiodifusión', '4155', True),
        ('415520', 'Telecomunicaciones', '4155', True),
        ('415525', 'Desarrollo de sistemas informáticos', '4155', True),
        ('415530', 'Procesamiento de datos y actividades conexas', '4155', True),
        ('415595', 'Otras actividades de servicios de información', '4155', True),
        ('4160', 'ACTIVIDADES FINANCIERAS Y DE SEGUROS', '41', False),
        ('416005', 'Intermediación financiera', '4160', True),
        ('416010', 'Actividades de servicios financieros', '4160', True),
        ('416015', 'Seguros', '4160', True),
        ('416020', 'Actividades auxiliares de servicios financieros', '4160', True),
        ('4165', 'ACTIVIDADES INMOBILIARIAS', '41', False),
        ('416505', 'Actividades inmobiliarias realizadas con bienes propios', '4165', True),
        ('416510', 'Actividades inmobiliarias realizadas a cambio de retribución', '4165', True),
        ('4170', 'ACTIVIDADES PROFESIONALES CIENTÍFICAS Y TÉCNICAS', '41', False),
        ('417005', 'Actividades jurídicas y de contabilidad', '4170', True),
        ('417010', 'Actividades de oficinas principales', '4170', True),
        ('417015', 'Actividades de arquitectura e ingeniería', '4170', True),
        ('417020', 'Investigación científica y desarrollo', '4170', True),
        ('417025', 'Publicidad y estudios de mercado', '4170', True),
        ('417030', 'Otras actividades profesionales científicas', '4170', True),
        ('417035', 'Actividades veterinarias', '4170', True),
        ('4175', 'ACTIVIDADES ADMINISTRATIVAS Y SERVICIOS DE APOYO', '41', False),
        ('417505', 'Actividades de alquiler y arrendamiento', '4175', True),
        ('417510', 'Actividades de empleo', '4175', True),
        ('417515', 'Actividades de agencias de viajes', '4175', True),
        ('417520', 'Actividades de investigación y seguridad', '4175', True),
        ('417525', 'Actividades de servicios a edificios', '4175', True),
        ('417530', 'Actividades administrativas de oficina', '4175', True),
        ('4180', 'ADMINISTRACIÓN PÚBLICA Y DEFENSA', '41', False),
        ('418005', 'Administración pública', '4180', True),
        ('418010', 'Defensa', '4180', True),
        ('418015', 'Seguridad social obligatoria', '4180', True),
        ('4185', 'EDUCACIÓN', '41', False),
        ('418505', 'Educación preescolar', '4185', True),
        ('418510', 'Educación básica primaria', '4185', True),
        ('418515', 'Educación básica secundaria', '4185', True),
        ('418520', 'Educación media académica', '4185', True),
        ('418525', 'Educación media técnica', '4185', True),
        ('418530', 'Educación técnica profesional', '4185', True),
        ('418535', 'Educación tecnológica', '4185', True),
        ('418540', 'Educación universitaria', '4185', True),
        ('418545', 'Educación de postgrado', '4185', True),
        ('418595', 'Otros tipos de educación', '4185', True),
        ('4190', 'ACTIVIDADES DE ATENCIÓN DE LA SALUD HUMANA', '41', False),
        ('419005', 'Actividades de hospitales y clínicas', '4190', True),
        ('419010', 'Actividades de la práctica médica', '4190', True),
        ('419015', 'Actividades de la práctica odontológica', '4190', True),
        ('419020', 'Otras actividades de atención de la salud humana', '4190', True),
        ('4195', 'ACTIVIDADES ARTÍSTICAS DE ENTRETENIMIENTO Y RECREACIÓN', '41', False),
        ('419505', 'Actividades creativas artísticas', '4195', True),
        ('419510', 'Actividades de bibliotecas archivos museos', '4195', True),
        ('419515', 'Actividades de juegos de azar y apuestas', '4195', True),
        ('419520', 'Actividades deportivas y recreativas', '4195', True),
        ('42', 'NO OPERACIONALES', '4', False),
        ('4205', 'FINANCIEROS', '42', False),
        ('420505', 'Intereses', '4205', True),
        ('420510', 'Rendimientos sobre inversiones', '4205', True),
        ('420515', 'Dividendos de sociedades anónimas', '4205', True),
        ('420520', 'Participaciones de sociedades limitadas', '4205', True),
        ('420525', 'Reajuste del sistema', '4205', True),
        ('420530', 'Descuentos comerciales condicionados', '4205', True),
        ('420535', 'Descuentos por pronto pago', '4205', True),
        ('420540', 'Diferencia en cambio', '4205', True),
        ('420545', 'Financiación vehículos', '4205', True),
        ('420550', 'Financiación otros activos', '4205', True),
        ('420595', 'Otros', '4205', True),
        ('4210', 'DIVIDENDOS Y PARTICIPACIONES', '42', False),
        ('421005', 'Dividendos de sociedades anónimas', '4210', True),
        ('421010', 'Participaciones en sociedades limitadas', '4210', True),
        ('4215', 'ARRENDAMIENTOS', '42', False),
        ('421505', 'Terrenos', '4215', True),
        ('421510', 'Construcciones y edificaciones', '4215', True),
        ('421515', 'Maquinaria y equipo', '4215', True),
        ('421520', 'Equipo de oficina', '4215', True),
        ('421525', 'Equipo de computación y comunicación', '4215', True),
        ('421530', 'Equipo médico científico', '4215', True),
        ('421535', 'Equipo de transporte', '4215', True),
        ('4220', 'COMISIONES', '42', False),
        ('422005', 'Sobre ventas', '4220', True),
        ('422010', 'Sobre compras', '4220', True),
        ('422015', 'Por cobranzas', '4220', True),
        ('422020', 'Bancarias', '4220', True),
        ('4225', 'HONORARIOS', '42', False),
        ('422505', 'Asesorías jurídicas', '4225', True),
        ('422510', 'Asesorías técnicas', '4225', True),
        ('422515', 'Asesorías financieras', '4225', True),
        ('422520', 'Asesorías administrativas', '4225', True),
        ('422595', 'Otros', '4225', True),
        ('4230', 'SERVICIOS', '42', False),
        ('423005', 'De báscula', '4230', True),
        ('423010', 'De transporte', '4230', True),
        ('423015', 'Administrativos', '4230', True),
        ('423020', 'Técnicos', '4230', True),
        ('423025', 'De computación', '4230', True),
        ('423030', 'De comunicación', '4230', True),
        ('423035', 'De mantenimiento', '4230', True),
        ('423040', 'De publicidad', '4230', True),
        ('423095', 'Otros', '4230', True),
        ('4235', 'UTILIDAD EN VENTA DE INVERSIONES', '42', False),
        ('423505', 'Acciones', '4235', True),
        ('423510', 'Cuotas o partes de interés social', '4235', True),
        ('423515', 'Bonos', '4235', True),
        ('423595', 'Otras', '4235', True),
        ('4240', 'UTILIDAD EN VENTA DE PROPIEDADES PLANTA Y EQUIPO', '42', False),
        ('424005', 'Terrenos', '4240', True),
        ('424010', 'Construcciones y edificaciones', '4240', True),
        ('424015', 'Maquinaria y equipo', '4240', True),
        ('424020', 'Equipo de oficina', '4240', True),
        ('424025', 'Equipo de computación y comunicación', '4240', True),
        ('424030', 'Equipo médico científico', '4240', True),
        ('424035', 'Equipo de transporte', '4240', True),
        ('424095', 'Otros', '4240', True),
        ('4245', 'UTILIDAD EN VENTA DE OTROS BIENES', '42', False),
        ('424505', 'Intangibles', '4245', True),
        ('424510', 'Otros activos', '4245', True),
        ('4250', 'RECUPERACIONES', '42', False),
        ('425005', 'Deudas malas', '4250', True),
        ('425010', 'Seguros', '4250', True),
        ('425015', 'Reclamos', '4250', True),
        ('425020', 'Reintegro por personal en comisión', '4250', True),
        ('425025', 'Descuentos concedidos', '4250', True),
        ('425030', 'Multas sanciones y litigios', '4250', True),
        ('425035', 'Gastos bancarios', '4250', True),
        ('425040', 'Impuestos asumidos por terceros', '4250', True),
        ('425045', 'Devoluciones de provisiones', '4250', True),
        ('425095', 'Otras', '4250', True),
        ('4255', 'INDEMNIZACIONES', '42', False),
        ('425505', 'Por siniestros', '4255', True),
        ('425510', 'Por suministros', '4255', True),
        ('425515', 'Lucro cesante compañías de seguros', '4255', True),
        ('425520', 'Daño emergente compañías de seguros', '4255', True),
        ('425525', 'Por pérdida de mercancía', '4255', True),
        ('425530', 'Por incapacidades ISS', '4255', True),
        ('425595', 'Otras', '4255', True),
        ('4295', 'DIVERSOS', '42', False),
        ('429505', 'Aprovechamientos', '4295', True),
        ('429510', 'Auxilios', '4295', True),
        ('429515', 'Subvenciones', '4295', True),
        ('429520', 'Bonificaciones', '4295', True),
        ('429525', 'Sobrantes de caja', '4295', True),
        ('429530', 'Sobrantes en liquidación fletes', '4295', True),
        ('429595', 'Otros', '4295', True),
        ('47', 'AJUSTES POR INFLACIÓN', '4', False),
        ('4705', 'CORRECCIÓN MONETARIA', '47', False),
        ('470505', 'Inversiones', '4705', True),
        ('470510', 'Inventarios', '4705', True),
        ('470515', 'Propiedades planta y equipo', '4705', True),
        ('470520', 'Intangibles', '4705', True),
        ('470525', 'Diferidos', '4705', True),
        ('470530', 'Otros activos', '4705', True),
        ('470535', 'Pasivos', '4705', True),
        ('470540', 'Patrimonio', '4705', True),
        ('48', 'OTROS INGRESOS', '4', False),
        ('4805', 'MÉTODO DE PARTICIPACIÓN', '48', False),
        ('480505', 'Sobre inversiones en sociedades anónimas', '4805', True),
        ('480510', 'Sobre inversiones en sociedades limitadas', '4805', True),
    ]
    
    # CLASE 5 - GASTOS
    gastos_accounts = [
        ('5', 'GASTOS', None, False),
        ('51', 'OPERACIONALES DE ADMINISTRACIÓN', '5', False),
        ('5105', 'GASTOS DE PERSONAL', '51', False),
        ('510506', 'Sueldos', '5105', True),
        ('510512', 'Jornales', '5105', True),
        ('510515', 'Horas extras y recargos', '5105', True),
        ('510518', 'Comisiones', '5105', True),
        ('510521', 'Viáticos', '5105', True),
        ('510524', 'Incapacidades', '5105', True),
        ('510527', 'Auxilio de transporte', '5105', True),
        ('510530', 'Cesantías', '5105', True),
        ('510533', 'Intereses sobre cesantías', '5105', True),
        ('510536', 'Prima de servicios', '5105', True),
        ('510539', 'Vacaciones', '5105', True),
        ('510542', 'Primas extralegales', '5105', True),
        ('510545', 'Auxilios', '5105', True),
        ('510548', 'Bonificaciones', '5105', True),
        ('510551', 'Dotación y suministro a trabajadores', '5105', True),
        ('510554', 'Seguros', '5105', True),
        ('510557', 'Cuotas partes pensiones de jubilación', '5105', True),
        ('510558', 'Amortización cálculo actuarial pensiones de jubilación', '5105', True),
        ('510559', 'Pensiones de jubilación', '5105', True),
        ('510560', 'Indemnizaciones laborales', '5105', True),
        ('510561', 'Capacitación al personal', '5105', True),
        ('510562', 'Gastos deportivos y de recreación', '5105', True),
        ('510563', 'Aportes a administradoras de riesgos profesionales ARP', '5105', True),
        ('510566', 'Aportes a entidades promotoras de salud EPS', '5105', True),
        ('510568', 'Aportes a fondos de pensiones y/o cesantías', '5105', True),
        ('510570', 'Aportes cajas de compensación familiar', '5105', True),
        ('510572', 'Aportes ICBF', '5105', True),
        ('510575', 'Aportes SENA', '5105', True),
        ('510578', 'Aportes sindicales', '5105', True),
        ('510595', 'Otros', '5105', True),
        ('5110', 'HONORARIOS', '51', False),
        ('511005', 'Junta directiva', '5110', True),
        ('511010', 'Revisoría fiscal', '5110', True),
        ('511015', 'Auditoría externa', '5110', True),
        ('511020', 'Avalúos', '5110', True),
        ('511025', 'Asesoría jurídica', '5110', True),
        ('511030', 'Asesoría financiera', '5110', True),
        ('511035', 'Asesoría técnica', '5110', True),
        ('511040', 'Otros honorarios', '5110', True),
        ('5115', 'IMPUESTOS', '51', False),
        ('511505', 'Industria y comercio', '5115', True),
        ('511510', 'De timbres', '5115', True),
        ('511515', 'A la propiedad raíz', '5115', True),
        ('511520', 'Derechos sobre instrumentos públicos', '5115', True),
        ('511525', 'De valorización', '5115', True),
        ('511530', 'De turismo', '5115', True),
        ('511535', 'Tasa por utilización de puertos', '5115', True),
        ('511540', 'De vehículos', '5115', True),
        ('511545', 'De espectáculos públicos', '5115', True),
        ('511550', 'Cuotas de fomento', '5115', True),
        ('511570', 'ICA', '5115', True),
        ('511595', 'Otros', '5115', True),
        ('5120', 'ARRENDAMIENTOS', '51', False),
        ('512005', 'Terrenos', '5120', True),
        ('512010', 'Construcciones y edificaciones', '5120', True),
        ('512015', 'Maquinaria y equipo', '5120', True),
        ('512020', 'Equipo de oficina', '5120', True),
        ('512025', 'Equipo de computación y comunicación', '5120', True),
        ('512030', 'Equipo médico científico', '5120', True),
        ('512035', 'Equipo de transporte', '5120', True),
        ('512095', 'Otros', '5120', True),
        ('5125', 'CONTRIBUCIONES Y AFILIACIONES', '51', False),
        ('512505', 'Contribuciones', '5125', True),
        ('512510', 'Afiliaciones y sostenimiento', '5125', True),
        ('5130', 'SEGUROS', '51', False),
        ('513005', 'Manejo', '5130', True),
        ('513010', 'Cumplimiento', '5130', True),
        ('513015', 'Corriente débil', '5130', True),
        ('513020', 'Vida colectiva', '5130', True),
        ('513025', 'Incendio', '5130', True),
        ('513030', 'Terremoto', '5130', True),
        ('513035', 'Sustracción y hurto', '5130', True),
        ('513040', 'Flota y equipo de transporte', '5130', True),
        ('513045', 'Responsabilidad civil y extracontractual', '5130', True),
        ('513050', 'Vuelo', '5130', True),
        ('513055', 'Rotura de maquinaria', '5130', True),
        ('513060', 'Obligatorio accidentes de tránsito', '5130', True),
        ('513065', 'Lucro cesante', '5130', True),
        ('513070', 'Responsabilidad civil productos', '5130', True),
        ('513075', 'Riesgos financieros (inversiones)', '5130', True),
        ('513095', 'Otros', '5130', True),
        ('5135', 'SERVICIOS', '51', False),
        ('513505', 'Aseo y vigilancia', '5135', True),
        ('513510', 'Temporales', '5135', True),
        ('513515', 'Asistencia técnica', '5135', True),
        ('513520', 'Procesamiento electrónico de datos', '5135', True),
        ('513525', 'Acueducto y alcantarillado', '5135', True),
        ('513530', 'Energía eléctrica', '5135', True),
        ('513535', 'Teléfono', '5135', True),
        ('513540', 'Correo portes y telegramas', '5135', True),
        ('513545', 'Fax y télex', '5135', True),
        ('513550', 'Internet', '5135', True),
        ('513555', 'Radio y televisión', '5135', True),
        ('513595', 'Otros', '5135', True),
        ('5140', 'GASTOS LEGALES', '51', False),
        ('514005', 'Notariales', '5140', True),
        ('514010', 'Registro mercantil', '5140', True),
        ('514015', 'Trámites y licencias', '5140', True),
        ('514020', 'Aduaneros', '5140', True),
        ('514025', 'Consulares', '5140', True),
        ('514095', 'Otros', '5140', True),
        ('5145', 'MANTENIMIENTO Y REPARACIONES', '51', False),
        ('514505', 'Terrenos', '5145', True),
        ('514510', 'Construcciones y edificaciones', '5145', True),
        ('514515', 'Maquinaria y equipo', '5145', True),
        ('514520', 'Equipo de oficina', '5145', True),
        ('514525', 'Equipo de computación y comunicación', '5145', True),
        ('514530', 'Equipo médico científico', '5145', True),
        ('514535', 'Equipo de transporte', '5145', True),
        ('514595', 'Otros', '5145', True),
        ('5150', 'ADECUACIÓN E INSTALACIÓN', '51', False),
        ('515005', 'Instalaciones eléctricas', '5150', True),
        ('515010', 'Arreglos ornamentales', '5150', True),
        ('515015', 'Reparaciones locativas', '5150', True),
        ('515095', 'Otros', '5150', True),
        ('5155', 'GASTOS DE VIAJE', '51', False),
        ('515505', 'Alojamiento y manutención', '5155', True),
        ('515510', 'Pasajes fluviales y marítimos', '5155', True),
        ('515515', 'Pasajes aéreos', '5155', True),
        ('515520', 'Pasajes terrestres', '5155', True),
        ('515525', 'Pasajes férreos', '5155', True),
        ('515595', 'Otros', '5155', True),
        ('5160', 'DEPRECIACIONES', '51', False),
        ('516005', 'Construcciones y edificaciones', '5160', True),
        ('516010', 'Maquinaria y equipo', '5160', True),
        ('516015', 'Equipo de oficina', '5160', True),
        ('516020', 'Equipo de computación y comunicación', '5160', True),
        ('516025', 'Equipo médico científico', '5160', True),
        ('516030', 'Equipo de transporte', '5160', True),
        ('516095', 'Depreciaciones diversas', '5160', True),
        ('5165', 'AMORTIZACIONES', '51', False),
        ('516505', 'Vías de comunicación', '5165', True),
        ('516510', 'Intangibles', '5165', True),
        ('516515', 'Cargos diferidos', '5165', True),
        ('516595', 'Otras', '5165', True),
        ('5195', 'DIVERSOS', '51', False),
        ('519505', 'Comisiones', '5195', True),
        ('519510', 'Libros suscripciones periódicos y revistas', '5195', True),
        ('519515', 'Museos bibliotecas y otros', '5195', True),
        ('519520', 'Gastos de representación y relaciones públicas', '5195', True),
        ('519525', 'Elementos de aseo y cafetería', '5195', True),
        ('519530', 'Útiles papelería y fotocopias', '5195', True),
        ('519535', 'Combustibles y lubricantes', '5195', True),
        ('519540', 'Envases y empaques', '5195', True),
        ('519545', 'Taxis y buses', '5195', True),
        ('519550', 'Estampillas', '5195', True),
        ('519555', 'Bajas de inventarios', '5195', True),
        ('519560', 'Sobrantes en liquidación de nómina', '5195', True),
        ('519565', 'Cuotas de administración', '5195', True),
        ('519570', 'Gastos bancarios', '5195', True),
        ('519575', 'Casino y restaurante', '5195', True),
        ('519595', 'Otros', '5195', True),
        ('52', 'OPERACIONALES DE VENTAS', '5', False),
        ('5205', 'GASTOS DE PERSONAL', '52', False),
        ('520506', 'Sueldos', '5205', True),
        ('520512', 'Jornales', '5205', True),
        ('520515', 'Horas extras y recargos', '5205', True),
        ('520518', 'Comisiones', '5205', True),
        ('520521', 'Viáticos', '5205', True),
        ('520524', 'Incapacidades', '5205', True),
        ('520527', 'Auxilio de transporte', '5205', True),
        ('520530', 'Cesantías', '5205', True),
        ('520533', 'Intereses sobre cesantías', '5205', True),
        ('520536', 'Prima de servicios', '5205', True),
        ('520539', 'Vacaciones', '5205', True),
        ('520542', 'Primas extralegales', '5205', True),
        ('520545', 'Auxilios', '5205', True),
        ('520548', 'Bonificaciones', '5205', True),
        ('520551', 'Dotación y suministro a trabajadores', '5205', True),
        ('520554', 'Seguros', '5205', True),
        ('520557', 'Cuotas partes pensiones de jubilación', '5205', True),
        ('520558', 'Amortización cálculo actuarial pensiones de jubilación', '5205', True),
        ('520559', 'Pensiones de jubilación', '5205', True),
        ('520560', 'Indemnizaciones laborales', '5205', True),
        ('520561', 'Capacitación al personal', '5205', True),
        ('520562', 'Gastos deportivos y de recreación', '5205', True),
        ('520563', 'Aportes a administradoras de riesgos profesionales ARP', '5205', True),
        ('520566', 'Aportes a entidades promotoras de salud EPS', '5205', True),
        ('520568', 'Aportes a fondos de pensiones y/o cesantías', '5205', True),
        ('520570', 'Aportes cajas de compensación familiar', '5205', True),
        ('520572', 'Aportes ICBF', '5205', True),
        ('520575', 'Aportes SENA', '5205', True),
        ('520578', 'Aportes sindicales', '5205', True),
        ('520595', 'Otros', '5205', True),
        ('5210', 'HONORARIOS', '52', False),
        ('521005', 'Asesoría jurídica', '5210', True),
        ('521010', 'Asesoría financiera', '5210', True),
        ('521015', 'Asesoría técnica', '5210', True),
        ('521095', 'Otros', '5210', True),
        ('5215', 'IMPUESTOS', '52', False),
        ('521505', 'Industria y comercio', '5215', True),
        ('521510', 'De timbres', '5215', True),
        ('521515', 'A la propiedad raíz', '5215', True),
        ('521520', 'Derechos sobre instrumentos públicos', '5215', True),
        ('521525', 'De valorización', '5215', True),
        ('521530', 'De turismo', '5215', True),
        ('521535', 'Tasa por utilización de puertos', '5215', True),
        ('521540', 'De vehículos', '5215', True),
        ('521545', 'De espectáculos públicos', '5215', True),
        ('521550', 'Cuotas de fomento', '5215', True),
        ('521570', 'ICA', '5215', True),
        ('521595', 'Otros', '5215', True),
        ('5220', 'ARRENDAMIENTOS', '52', False),
        ('522005', 'Terrenos', '5220', True),
        ('522010', 'Construcciones y edificaciones', '5220', True),
        ('522015', 'Maquinaria y equipo', '5220', True),
        ('522020', 'Equipo de oficina', '5220', True),
        ('522025', 'Equipo de computación y comunicación', '5220', True),
        ('522030', 'Equipo médico científico', '5220', True),
        ('522035', 'Equipo de transporte', '5220', True),
        ('522095', 'Otros', '5220', True),
        ('5225', 'CONTRIBUCIONES Y AFILIACIONES', '52', False),
        ('522505', 'Contribuciones', '5225', True),
        ('522510', 'Afiliaciones y sostenimiento', '5225', True),
        ('5230', 'SEGUROS', '52', False),
        ('523005', 'Manejo', '5230', True),
        ('523010', 'Cumplimiento', '5230', True),
        ('523015', 'Corriente débil', '5230', True),
        ('523020', 'Vida colectiva', '5230', True),
        ('523025', 'Incendio', '5230', True),
        ('523030', 'Terremoto', '5230', True),
        ('523035', 'Sustracción y hurto', '5230', True),
        ('523040', 'Flota y equipo de transporte', '5230', True),
        ('523045', 'Responsabilidad civil y extracontractual', '5230', True),
        ('523050', 'Vuelo', '5230', True),
        ('523055', 'Rotura de maquinaria', '5230', True),
        ('523060', 'Obligatorio accidentes de tránsito', '5230', True),
        ('523065', 'Lucro cesante', '5230', True),
        ('523070', 'Responsabilidad civil productos', '5230', True),
        ('523075', 'Riesgos financieros (inversiones)', '5230', True),
        ('523095', 'Otros', '5230', True),
        ('5235', 'SERVICIOS', '52', False),
        ('523505', 'Aseo y vigilancia', '5235', True),
        ('523510', 'Temporales', '5235', True),
        ('523515', 'Asistencia técnica', '5235', True),
        ('523520', 'Procesamiento electrónico de datos', '5235', True),
        ('523525', 'Acueducto y alcantarillado', '5235', True),
        ('523530', 'Energía eléctrica', '5235', True),
        ('523535', 'Teléfono', '5235', True),
        ('523540', 'Correo portes y telegramas', '5235', True),
        ('523545', 'Fax y télex', '5235', True),
        ('523550', 'Internet', '5235', True),
        ('523555', 'Radio y televisión', '5235', True),
        ('523595', 'Otros', '5235', True),
        ('5240', 'GASTOS LEGALES', '52', False),
        ('524005', 'Notariales', '5240', True),
        ('524010', 'Registro mercantil', '5240', True),
        ('524015', 'Trámites y licencias', '5240', True),
        ('524020', 'Aduaneros', '5240', True),
        ('524025', 'Consulares', '5240', True),
        ('524095', 'Otros', '5240', True),
        ('5245', 'MANTENIMIENTO Y REPARACIONES', '52', False),
        ('524505', 'Terrenos', '5245', True),
        ('524510', 'Construcciones y edificaciones', '5245', True),
        ('524515', 'Maquinaria y equipo', '5245', True),
        ('524520', 'Equipo de oficina', '5245', True),
        ('524525', 'Equipo de computación y comunicación', '5245', True),
        ('524530', 'Equipo médico científico', '5245', True),
        ('524535', 'Equipo de transporte', '5245', True),
        ('524595', 'Otros', '5245', True),
        ('5250', 'ADECUACIÓN E INSTALACIÓN', '52', False),
        ('525005', 'Instalaciones eléctricas', '5250', True),
        ('525010', 'Arreglos ornamentales', '5250', True),
        ('525015', 'Reparaciones locativas', '5250', True),
        ('525095', 'Otros', '5250', True),
        ('5255', 'GASTOS DE VIAJE', '52', False),
        ('525505', 'Alojamiento y manutención', '5255', True),
        ('525510', 'Pasajes fluviales y marítimos', '5255', True),
        ('525515', 'Pasajes aéreos', '5255', True),
        ('525520', 'Pasajes terrestres', '5255', True),
        ('525525', 'Pasajes férreos', '5255', True),
        ('525595', 'Otros', '5255', True),
        ('5260', 'DEPRECIACIONES', '52', False),
        ('526005', 'Construcciones y edificaciones', '5260', True),
        ('526010', 'Maquinaria y equipo', '5260', True),
        ('526015', 'Equipo de oficina', '5260', True),
        ('526020', 'Equipo de computación y comunicación', '5260', True),
        ('526025', 'Equipo médico científico', '5260', True),
        ('526030', 'Equipo de transporte', '5260', True),
        ('526095', 'Depreciaciones diversas', '5260', True),
        ('5265', 'AMORTIZACIONES', '52', False),
        ('526505', 'Vías de comunicación', '5265', True),
        ('526510', 'Intangibles', '5265', True),
        ('526515', 'Cargos diferidos', '5265', True),
        ('526595', 'Otras', '5265', True),
        ('5270', 'PROVISIONES', '52', False),
        ('527005', 'Inversiones', '5270', True),
        ('527010', 'Deudores', '5270', True),
        ('527015', 'Inventarios', '5270', True),
        ('527095', 'Diversas', '5270', True),
        ('5275', 'PUBLICIDAD PROPAGANDA Y PROMOCIÓN', '52', False),
        ('527505', 'Avisos y tableros', '5275', True),
        ('527510', 'Avisos en prensa y revistas', '5275', True),
        ('527515', 'Programas de radio y televisión', '5275', True),
        ('527520', 'Catálogos', '5275', True),
        ('527525', 'Propaganda y promoción', '5275', True),
        ('527595', 'Otros', '5275', True),
        ('5295', 'DIVERSOS', '52', False),
        ('529505', 'Comisiones', '5295', True),
        ('529510', 'Libros suscripciones periódicos y revistas', '5295', True),
        ('529515', 'Museos bibliotecas y otros', '5295', True),
        ('529520', 'Gastos de representación y relaciones públicas', '5295', True),
        ('529525', 'Elementos de aseo y cafetería', '5295', True),
        ('529530', 'Útiles papelería y fotocopias', '5295', True),
        ('529535', 'Combustibles y lubricantes', '5295', True),
        ('529540', 'Envases y empaques', '5295', True),
        ('529545', 'Taxis y buses', '5295', True),
        ('529550', 'Estampillas', '5295', True),
        ('529555', 'Bajas de inventarios', '5295', True),
        ('529560', 'Sobrantes en liquidación de nómina', '5295', True),
        ('529565', 'Cuotas de administración', '5295', True),
        ('529570', 'Gastos bancarios', '5295', True),
        ('529575', 'Casino y restaurante', '5295', True),
        ('529595', 'Otros', '5295', True),
        ('53', 'NO OPERACIONALES', '5', False),
        ('5305', 'FINANCIEROS', '53', False),
        ('530505', 'Gastos bancarios', '5305', True),
        ('530510', 'Reajuste del sistema', '5305', True),
        ('530515', 'Comisiones', '5305', True),
        ('530520', 'Intereses', '5305', True),
        ('530525', 'Diferencia en cambio', '5305', True),
        ('530530', 'Gastos en negociación certificados de cambio', '5305', True),
        ('530535', 'Descuentos comerciales condicionados', '5305', True),
        ('530540', 'Financiación vehículos', '5305', True),
        ('530545', 'Financiación otros activos', '5305', True),
        ('530595', 'Otros', '5305', True),
        ('5310', 'PÉRDIDA EN VENTA Y RETIRO DE BIENES', '53', False),
        ('531005', 'Inversiones', '5310', True),
        ('531010', 'Propiedades planta y equipo', '5310', True),
        ('531015', 'Otros activos', '5310', True),
        ('5315', 'GASTOS EXTRAORDINARIOS', '53', False),
        ('531505', 'Costas y procesos judiciales', '5315', True),
        ('531510', 'Actividades culturales y cívicas', '5315', True),
        ('531515', 'Costos y gastos de ejercicios anteriores', '5315', True),
        ('531520', 'Impuestos asumidos', '5315', True),
        ('531525', 'Multas sanciones y litigios', '5315', True),
        ('531530', 'Donaciones', '5315', True),
        ('531595', 'Otros', '5315', True),
        ('5395', 'GASTOS DIVERSOS', '53', False),
        ('539505', 'Demandas laborales', '5395', True),
        ('539510', 'Demandas civiles', '5395', True),
        ('539515', 'Indemnizaciones', '5395', True),
        ('539520', 'Deudas de difícil cobro', '5395', True),
        ('539525', 'Provisiones', '5395', True),
        ('539530', 'Gastos diversos ejercicios anteriores', '5395', True),
        ('539595', 'Otros', '5395', True),
        ('54', 'IMPUESTO DE RENTA Y COMPLEMENTARIOS', '5', False),
        ('5405', 'IMPUESTO DE RENTA Y COMPLEMENTARIOS', '54', False),
        ('540505', 'Impuesto de renta y complementarios', '5405', True),
        ('57', 'AJUSTES POR INFLACIÓN', '5', False),
        ('5705', 'CORRECCIÓN MONETARIA', '57', False),
        ('570505', 'Inversiones', '5705', True),
        ('570510', 'Inventarios', '5705', True),
        ('570515', 'Propiedades planta y equipo', '5705', True),
        ('570520', 'Intangibles', '5705', True),
        ('570525', 'Diferidos', '5705', True),
        ('570530', 'Otros activos', '5705', True),
        ('570535', 'Pasivos', '5705', True),
        ('570540', 'Patrimonio', '5705', True),
        ('58', 'OTROS GASTOS', '5', False),
        ('5805', 'MÉTODO DE PARTICIPACIÓN', '58', False),
        ('580505', 'Sobre inversiones en sociedades anónimas', '5805', True),
        ('580510', 'Sobre inversiones en sociedades limitadas', '5805', True),
    ]
    
    # CLASE 6 - COSTOS DE VENTAS
    costos_accounts = [
        ('6', 'COSTO DE VENTAS', None, False),
        ('61', 'COSTO DE VENTAS Y DE PRESTACIÓN DE SERVICIOS', '6', False),
        ('6105', 'AGRICULTURA GANADERÍA CAZA Y SILVICULTURA', '61', False),
        ('610505', 'Actividad agrícola', '6105', True),
        ('610510', 'Actividad ganadera', '6105', True),
        ('610515', 'Actividad avícola', '6105', True),
        ('610520', 'Actividad porcícola', '6105', True),
        ('610525', 'Actividad apícola', '6105', True),
        ('610530', 'Actividad piscícola', '6105', True),
        ('610535', 'Actividad de caza', '6105', True),
        ('610540', 'Actividad de silvicultura', '6105', True),
        ('6110', 'PESCA', '61', False),
        ('611005', 'Pesca marítima', '6110', True),
        ('611010', 'Pesca fluvial', '6110', True),
        ('611015', 'Pesca lacustre', '6110', True),
        ('6115', 'EXPLOTACIÓN DE MINAS Y CANTERAS', '61', False),
        ('611505', 'Carbón', '6115', True),
        ('611510', 'Petróleo crudo', '6115', True),
        ('611515', 'Gas natural', '6115', True),
        ('611520', 'Minerales metálicos', '6115', True),
        ('611525', 'Minerales no metálicos', '6115', True),
        ('611530', 'Minerales de sal', '6115', True),
        ('611595', 'Otros', '6115', True),
        ('6120', 'INDUSTRIAS MANUFACTURERAS', '61', False),
        ('612001', 'Alimentos', '6120', True),
        ('612002', 'Bebidas', '6120', True),
        ('612003', 'Productos de tabaco', '6120', True),
        ('612004', 'Productos textiles', '6120', True),
        ('612005', 'Prendas de vestir', '6120', True),
        ('612006', 'Cuero y productos conexos', '6120', True),
        ('612007', 'Madera y productos de madera', '6120', True),
        ('612008', 'Papel cartón y productos de papel', '6120', True),
        ('612009', 'Actividades de impresión', '6120', True),
        ('612010', 'Productos químicos', '6120', True),
        ('612011', 'Productos farmacéuticos', '6120', True),
        ('612012', 'Productos de caucho y plástico', '6120', True),
        ('612013', 'Productos minerales no metálicos', '6120', True),
        ('612014', 'Productos metalúrgicos básicos', '6120', True),
        ('612015', 'Productos metálicos', '6120', True),
        ('612016', 'Productos informáticos electrónicos', '6120', True),
        ('612017', 'Aparatos eléctricos', '6120', True),
        ('612018', 'Maquinaria y equipo', '6120', True),
        ('612019', 'Vehículos automotores', '6120', True),
        ('612020', 'Otros tipos de transporte', '6120', True),
        ('612021', 'Muebles', '6120', True),
        ('612095', 'Otros', '6120', True),
        ('6125', 'SUMINISTRO DE ELECTRICIDAD GAS VAPOR Y AIRE ACONDICIONADO', '61', False),
        ('612505', 'Energía eléctrica', '6125', True),
        ('612510', 'Gas por tubería', '6125', True),
        ('612515', 'Vapor y aire acondicionado', '6125', True),
        ('6130', 'DISTRIBUCIÓN DE AGUA EVACUACIÓN DE AGUAS RESIDUALES', '61', False),
        ('613005', 'Distribución de agua', '6130', True),
        ('613010', 'Evacuación de aguas residuales', '6130', True),
        ('613015', 'Gestión de desechos', '6130', True),
        ('6135', 'CONSTRUCCIÓN', '61', False),
        ('613505', 'Construcción de edificios', '6135', True),
        ('613510', 'Construcción de carreteras y vías de ferrocarril', '6135', True),
        ('613515', 'Construcción de proyectos de servicio público', '6135', True),
        ('613520', 'Construcción de otras obras de ingeniería civil', '6135', True),
        ('613525', 'Demolición y preparación del terreno', '6135', True),
        ('613530', 'Instalaciones eléctricas de fontanería', '6135', True),
        ('613535', 'Terminación y acabado de edificios', '6135', True),
        ('613595', 'Otras actividades especializadas para la construcción', '6135', True),
        ('6140', 'COMERCIO AL POR MAYOR Y AL POR MENOR', '61', False),
        ('614005', 'Venta de vehículos automotores', '6140', True),
        ('614010', 'Mantenimiento y reparación de vehículos automotores', '6140', True),
        ('614015', 'Venta de partes piezas y accesorios', '6140', True),
        ('614020', 'Comercio al por mayor', '6140', True),
        ('614025', 'Comercio al por menor', '6140', True),
        ('6145', 'TRANSPORTE Y ALMACENAMIENTO', '61', False),
        ('614505', 'Transporte terrestre', '6145', True),
        ('614510', 'Transporte marítimo y por vías navegables', '6145', True),
        ('614515', 'Transporte aéreo', '6145', True),
        ('614520', 'Almacenamiento y actividades complementarias al transporte', '6145', True),
        ('614525', 'Correo y servicios de mensajería', '6145', True),
        ('6150', 'ALOJAMIENTO Y SERVICIOS DE COMIDA', '61', False),
        ('615005', 'Actividades de alojamiento', '6150', True),
        ('615010', 'Actividades de servicios de comidas y bebidas', '6150', True),
        ('6155', 'INFORMACIÓN Y COMUNICACIONES', '61', False),
        ('615505', 'Actividades de edición', '6155', True),
        ('615510', 'Actividades cinematográficas de vídeo', '6155', True),
        ('615515', 'Actividades de radiodifusión', '6155', True),
        ('615520', 'Telecomunicaciones', '6155', True),
        ('615525', 'Desarrollo de sistemas informáticos', '6155', True),
        ('615530', 'Procesamiento de datos y actividades conexas', '6155', True),
        ('615595', 'Otras actividades de servicios de información', '6155', True),
        ('6160', 'ACTIVIDADES FINANCIERAS Y DE SEGUROS', '61', False),
        ('616005', 'Intermediación financiera', '6160', True),
        ('616010', 'Actividades de servicios financieros', '6160', True),
        ('616015', 'Seguros', '6160', True),
        ('616020', 'Actividades auxiliares de servicios financieros', '6160', True),
        ('6165', 'ACTIVIDADES INMOBILIARIAS', '61', False),
        ('616505', 'Actividades inmobiliarias realizadas con bienes propios', '6165', True),
        ('616510', 'Actividades inmobiliarias realizadas a cambio de retribución', '6165', True),
        ('6170', 'ACTIVIDADES PROFESIONALES CIENTÍFICAS Y TÉCNICAS', '61', False),
        ('617005', 'Actividades jurídicas y de contabilidad', '6170', True),
        ('617010', 'Actividades de oficinas principales', '6170', True),
        ('617015', 'Actividades de arquitectura e ingeniería', '6170', True),
        ('617020', 'Investigación científica y desarrollo', '6170', True),
        ('617025', 'Publicidad y estudios de mercado', '6170', True),
        ('617030', 'Otras actividades profesionales científicas', '6170', True),
        ('617035', 'Actividades veterinarias', '6170', True),
        ('6175', 'ACTIVIDADES ADMINISTRATIVAS Y SERVICIOS DE APOYO', '61', False),
        ('617505', 'Actividades de alquiler y arrendamiento', '6175', True),
        ('617510', 'Actividades de empleo', '6175', True),
        ('617515', 'Actividades de agencias de viajes', '6175', True),
        ('617520', 'Actividades de investigación y seguridad', '6175', True),
        ('617525', 'Actividades de servicios a edificios', '6175', True),
        ('617530', 'Actividades administrativas de oficina', '6175', True),
        ('6180', 'ADMINISTRACIÓN PÚBLICA Y DEFENSA', '61', False),
        ('618005', 'Administración pública', '6180', True),
        ('618010', 'Defensa', '6180', True),
        ('618015', 'Seguridad social obligatoria', '6180', True),
        ('6185', 'EDUCACIÓN', '61', False),
        ('618505', 'Educación preescolar', '6185', True),
        ('618510', 'Educación básica primaria', '6185', True),
        ('618515', 'Educación básica secundaria', '6185', True),
        ('618520', 'Educación media académica', '6185', True),
        ('618525', 'Educación media técnica', '6185', True),
        ('618530', 'Educación técnica profesional', '6185', True),
        ('618535', 'Educación tecnológica', '6185', True),
        ('618540', 'Educación universitaria', '6185', True),
        ('618545', 'Educación de postgrado', '6185', True),
        ('618595', 'Otros tipos de educación', '6185', True),
        ('6190', 'ACTIVIDADES DE ATENCIÓN DE LA SALUD HUMANA', '61', False),
        ('619005', 'Actividades de hospitales y clínicas', '6190', True),
        ('619010', 'Actividades de la práctica médica', '6190', True),
        ('619015', 'Actividades de la práctica odontológica', '6190', True),
        ('619020', 'Otras actividades de atención de la salud humana', '6190', True),
        ('6195', 'ACTIVIDADES ARTÍSTICAS DE ENTRETENIMIENTO Y RECREACIÓN', '61', False),
        ('619505', 'Actividades creativas artísticas', '6195', True),
        ('619510', 'Actividades de bibliotecas archivos museos', '6195', True),
        ('619515', 'Actividades de juegos de azar y apuestas', '6195', True),
        ('619520', 'Actividades deportivas y recreativas', '6195', True),
        ('62', 'COMPRAS', '6', False),
        ('6205', 'DE MATERIAS PRIMAS', '62', False),
        ('620505', 'Materias primas para productos vendidos', '6205', True),
        ('6210', 'DE MATERIALES INDIRECTOS', '62', False),
        ('621005', 'Materiales indirectos para productos vendidos', '6210', True),
        ('6215', 'DE ENVASES Y EMPAQUES', '62', False),
        ('621505', 'Envases para productos vendidos', '6215', True),
        ('621510', 'Empaques para productos vendidos', '6215', True),
        ('6220', 'DE SUMINISTROS PARA PRODUCCIÓN', '62', False),
        ('622005', 'Combustibles', '6220', True),
        ('622010', 'Lubricantes', '6220', True),
        ('622015', 'Energía', '6220', True),
        ('622095', 'Otros', '6220', True),
        ('6225', 'DEVOLUCIONES EN COMPRAS (DB)', '62', False),
        ('622505', 'Materias primas', '6225', True),
        ('622510', 'Materiales indirectos', '6225', True),
        ('622515', 'Envases y empaques', '6225', True),
        ('622595', 'Otros', '6225', True),
    ]
    
    # Todas las cuentas de clases 4-6
    all_remaining_accounts = ingresos_accounts + gastos_accounts + costos_accounts
    
    for company in companies:
        print(f'\n[*] Agregando clases 4-6 para empresa: {company.name}')
        
        # Obtener plan de cuentas existente
        chart = ChartOfAccounts.objects.filter(company=company).first()
        if not chart:
            print(f'[ERROR] No se encontro plan de cuentas para {company.name}')
            continue
        
        created_count = 0
        for code, name, parent_code, is_detail in all_remaining_accounts:
            # Determinar tipo de cuenta basado en el primer dígito
            first_digit = code[0]
            account_type = account_types.get(first_digit)
            
            if not account_type:
                continue
            
            # Buscar cuenta padre
            parent = None
            if parent_code:
                parent = Account.objects.filter(
                    chart_of_accounts=chart, 
                    code=parent_code
                ).first()
            
            # Determinar el nivel
            level = len(code)
            if level == 1:
                level = 1  # Clase
            elif level == 2:
                level = 2  # Grupo
            elif level == 4:
                level = 3  # Cuenta
            elif level == 6:
                level = 4  # Subcuenta
            else:
                level = 4  # Por defecto
            
            # Crear cuenta si no existe
            account, created = Account.objects.get_or_create(
                chart_of_accounts=chart,
                code=code,
                defaults={
                    'name': name,
                    'account_type': account_type,
                    'parent': parent,
                    'level': level,
                    'is_detail': is_detail,
                    'is_active': True,
                    'description': f'Cuenta {name} del PUC colombiano según Decreto 2650/93',
                    'created_by': admin_user
                }
            )
            
            if created:
                created_count += 1
        
        print(f'   [+] Se crearon {created_count} nuevas cuentas para {chart.company.name}')

if __name__ == '__main__':
    print('[*] Agregando clases restantes del PUC (4-6)...')
    add_remaining_puc_classes()
    print('[OK] Clases 4-6 del PUC agregadas exitosamente!')