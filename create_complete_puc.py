#!/usr/bin/env python
"""
Script para crear el Plan Único de Cuentas (PUC) completo de Colombia
según el Decreto 2650 de 1993.
"""
import os
import sys
import django

# Setup Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'contabilidad_multiempresa.settings')
django.setup()

from core.models import Company, User
from accounting.models import ChartOfAccounts, AccountType, Account

def create_complete_puc():
    """Crear el PUC completo de Colombia para todas las empresas."""
    companies = Company.objects.all()
    
    # Obtener usuario admin
    admin_user = User.objects.filter(is_superuser=True).first()
    if not admin_user:
        print("[ERROR] No se encontro usuario administrador.")
        return
    
    # Crear tipos de cuenta si no existen
    account_types = [
        ('1', 'Activo', 'asset', 'debit', True, False),
        ('2', 'Pasivo', 'liability', 'credit', True, False),
        ('3', 'Patrimonio', 'equity', 'credit', True, False),
        ('4', 'Ingresos', 'income', 'credit', False, True),
        ('5', 'Gastos', 'expense', 'debit', False, True),
        ('6', 'Costos', 'cost', 'debit', False, True),
        ('7', 'Costos de Producción', 'cost', 'debit', False, True),
        ('8', 'Cuentas de Orden Deudoras', 'asset', 'debit', False, False),
        ('9', 'Cuentas de Orden Acreedoras', 'liability', 'credit', False, False),
    ]
    
    for code, name, type_val, nature, is_balance_sheet, is_income_statement in account_types:
        AccountType.objects.get_or_create(
            code=code,
            defaults={
                'name': name,
                'type': type_val,
                'nature': nature,
                'is_balance_sheet': is_balance_sheet,
                'is_income_statement': is_income_statement
            }
        )
    
    for company in companies:
        print(f'\n[*] Procesando empresa: {company.name}')
        
        # Obtener o crear plan de cuentas
        chart, created = ChartOfAccounts.objects.get_or_create(
            company=company,
            defaults={
                'name': f'Plan Único de Cuentas (PUC) - {company.name}',
                'description': f'PUC según Decreto 2650 de 1993 para {company.name}',
                'account_code_length': 6,
                'cost_center_required': False,
                'created_by': admin_user
            }
        )
        
        if created:
            print(f'[+] Plan de cuentas creado para: {company.name}')
        else:
            print(f'[INFO] Plan de cuentas ya existe para: {company.name}')
        
        # Crear cuentas del PUC completo
        create_complete_accounts(chart, admin_user)

def create_complete_accounts(chart, admin_user):
    """Crear todas las cuentas del PUC colombiano."""
    
    # Obtener tipos de cuenta
    account_types = {}
    for at in AccountType.objects.all():
        account_types[at.code] = at
    
    # CLASE 1 - ACTIVOS
    activos_accounts = [
        # Clase, Grupo, Cuenta, Subcuenta
        ('1', 'ACTIVO', None, False),
        ('11', 'DISPONIBLE', '1', False),
        ('1105', 'CAJA', '11', False),
        ('110505', 'Caja general', '1105', True),
        ('110510', 'Cajas menores', '1105', True),
        ('110515', 'Moneda extranjera', '1105', True),
        ('1110', 'BANCOS', '11', False),
        ('111005', 'Moneda nacional', '1110', True),
        ('111010', 'Moneda extranjera', '1110', True),
        ('1120', 'CUENTAS DE AHORRO', '11', False),
        ('112005', 'Bancos', '1120', True),
        ('1125', 'FONDOS', '11', False),
        ('112505', 'Rotatorios moneda nacional', '1125', True),
        ('12', 'INVERSIONES', '1', False),
        ('1205', 'ACCIONES', '12', False),
        ('120505', 'Agricultura ganadería caza y silvicultura', '1205', True),
        ('120510', 'Pesca', '1205', True),
        ('120515', 'Explotación de minas y canteras', '1205', True),
        ('120520', 'Industria manufacturera', '1205', True),
        ('120525', 'Suministro de electricidad gas y agua', '1205', True),
        ('120530', 'Construcción', '1205', True),
        ('120535', 'Comercio al por mayor y al por menor', '1205', True),
        ('120540', 'Hoteles y restaurantes', '1205', True),
        ('120545', 'Transporte almacenamiento y comunicaciones', '1205', True),
        ('120550', 'Actividad financiera', '1205', True),
        ('120555', 'Actividades inmobiliarias empresariales y de alquiler', '1205', True),
        ('120560', 'Enseñanza', '1205', True),
        ('120565', 'Servicios sociales y de salud', '1205', True),
        ('120570', 'Otras actividades de servicios comunitarios', '1205', True),
        ('1210', 'CUOTAS O PARTES DE INTERES SOCIAL', '12', False),
        ('121005', 'Agricultura ganadería caza y silvicultura', '1210', True),
        ('1215', 'BONOS', '12', False),
        ('121505', 'Bonos públicos moneda nacional', '1215', True),
        ('121510', 'Bonos públicos moneda extranjera', '1215', True),
        ('1220', 'CEDULAS', '12', False),
        ('122005', 'Cédulas de capitalización', '1220', True),
        ('1225', 'CERTIFICADOS', '12', False),
        ('122505', 'Certificados de depósito a término', '1225', True),
        ('1230', 'PAPELES COMERCIALES', '12', False),
        ('123005', 'Sector privado', '1230', True),
        ('1240', 'ACEPTACIONES FINANCIERAS', '12', False),
        ('124005', 'Bancos comerciales', '1240', True),
        ('1245', 'DERECHOS FIDUCIARIOS', '12', False),
        ('124505', 'Moneda nacional', '1245', True),
        ('1250', 'DERECHOS DE RECOMPRA DE INVERSIONES NEGOCIADAS', '12', False),
        ('125005', 'Acciones', '1250', True),
        ('1255', 'OBLIGATORIAS', '12', False),
        ('125505', 'Bonos de financiamiento especial', '1255', True),
        ('1260', 'CUENTAS EN PARTICIPACION', '12', False),
        ('126005', 'Agricultura ganadería caza y silvicultura', '1260', True),
        ('1295', 'OTRAS INVERSIONES', '12', False),
        ('129505', 'Aportes en cooperativas', '1295', True),
        ('13', 'DEUDORES', '1', False),
        ('1305', 'CLIENTES', '13', False),
        ('130505', 'Nacionales', '1305', True),
        ('130510', 'Del exterior', '1305', True),
        ('130515', 'Deudores del sistema', '1305', True),
        ('130520', 'Garantías radicadas en el exterior', '1305', True),
        ('130525', 'Décimo tercer mes', '1305', True),
        ('1310', 'CUENTAS CORRIENTES COMERCIALES', '13', False),
        ('131005', 'Casa matriz', '1310', True),
        ('131010', 'Compañías vinculadas', '1310', True),
        ('131015', 'Accionistas o socios', '1310', True),
        ('131020', 'Particulares', '1310', True),
        ('1315', 'CUENTAS POR COBRAR A CASA MATRIZ', '13', False),
        ('131505', 'Ventas', '1315', True),
        ('131510', 'Préstamos', '1315', True),
        ('131515', 'Dividendos y participaciones', '1315', True),
        ('131520', 'Servicios', '1315', True),
        ('131525', 'Honorarios', '1315', True),
        ('131530', 'Arrendamientos', '1315', True),
        ('1320', 'CUENTAS POR COBRAR A VINCULADOS ECONOMICOS', '13', False),
        ('132005', 'Filiales', '1320', True),
        ('132010', 'Subsidiarias', '1320', True),
        ('132015', 'Sucursales', '1320', True),
        ('1325', 'CUENTAS POR COBRAR A SOCIOS Y ACCIONISTAS', '13', False),
        ('132505', 'A socios', '1325', True),
        ('132510', 'A accionistas', '1325', True),
        ('1330', 'ANTICIPOS Y AVANCES', '13', False),
        ('133005', 'A proveedores', '1330', True),
        ('133010', 'A contratistas', '1330', True),
        ('133015', 'A trabajadores', '1330', True),
        ('133020', 'A agentes', '1330', True),
        ('1340', 'PROMESAS DE COMPRAVENTA', '13', False),
        ('134005', 'De bienes raíces', '1340', True),
        ('1345', 'INGRESOS POR COBRAR', '13', False),
        ('134505', 'Dividendos y participaciones', '1345', True),
        ('134510', 'Comisiones', '1345', True),
        ('134515', 'Honorarios', '1345', True),
        ('134520', 'Servicios', '1345', True),
        ('134525', 'Arrendamientos', '1345', True),
        ('134530', 'Intereses', '1345', True),
        ('134535', 'Reajuste del sistema', '1345', True),
        ('134540', 'De suscripciones', '1345', True),
        ('1350', 'RETENCIÓN SOBRE CONTRATOS', '13', False),
        ('135005', 'De obras de urbanización', '1350', True),
        ('135010', 'De construcción', '1350', True),
        ('1355', 'ANTICIPO DE IMPUESTOS Y CONTRIBUCIONES', '13', False),
        ('135505', 'Anticipo de renta y complementarios', '1355', True),
        ('135510', 'Anticipo de industria y comercio', '1355', True),
        ('135515', 'Retención en la fuente', '1355', True),
        ('135520', 'Impuesto a las ventas retenido', '1355', True),
        ('135525', 'Sobrantes en liquidación privada de impuestos', '1355', True),
        ('1360', 'RECLAMACIONES', '13', False),
        ('136005', 'A compañías aseguradoras', '1360', True),
        ('136010', 'A transportadoras', '1360', True),
        ('136015', 'Otras', '1360', True),
        ('1365', 'CUENTAS POR COBRAR A TRABAJADORES', '13', False),
        ('136505', 'Vivienda', '1365', True),
        ('136510', 'Vehículos', '1365', True),
        ('136515', 'Préstamos', '1365', True),
        ('136520', 'Educación', '1365', True),
        ('136525', 'Médicos y odontológicos', '1365', True),
        ('136530', 'Calamidad doméstica', '1365', True),
        ('1370', 'PRÉSTAMOS A PARTICULARES', '13', False),
        ('137005', 'Con garantía real', '1370', True),
        ('137010', 'Con garantía personal', '1370', True),
        ('137015', 'A empleados y trabajadores', '1370', True),
        ('1380', 'DEUDORES VARIOS', '13', False),
        ('138005', 'Depositos entregados en garantía', '1380', True),
        ('138010', 'Préstamos sobre pólizas de seguros de vida', '1380', True),
        ('138015', 'Anticipos sobre liquidaciones laborales', '1380', True),
        ('138020', 'Legalizaciones en trámite', '1380', True),
        ('138025', 'Depósitos judicial', '1380', True),
        ('1385', 'DERECHOS DE RECOMPRA DE CARTERA NEGOCIADA', '13', False),
        ('138505', 'Vigente', '1385', True),
        ('1390', 'DEUDAS DE DIFICIL COBRO', '13', False),
        ('139005', 'Clientes', '1390', True),
        ('139010', 'Cuentas corrientes comerciales', '1390', True),
        ('1399', 'PROVISIONES', '13', False),
        ('139905', 'Clientes', '1399', True),
        ('139910', 'Cuentas corrientes comerciales', '1399', True),
        # Continúo con más cuentas...
        ('14', 'INVENTARIOS', '1', False),
        ('1405', 'MATERIAS PRIMAS', '14', False),
        ('140505', 'Nacionales', '1405', True),
        ('140510', 'Importadas', '1405', True),
        ('1410', 'PRODUCTOS EN PROCESO', '14', False),
        ('141005', 'Productos manufacturados', '1410', True),
        ('141010', 'Contratos en ejecución', '1410', True),
        ('141015', 'Cultivos en desarrollo', '1410', True),
        ('141020', 'Plantaciones en desarrollo', '1410', True),
        ('1415', 'PRODUCTOS TERMINADOS', '14', False),
        ('141505', 'Productos manufacturados', '1415', True),
        ('141510', 'Productos extraídos', '1415', True),
        ('141515', 'Productos agrícolas', '1415', True),
        ('141520', 'Productos de pesca', '1415', True),
        ('1420', 'MERCANCIAS NO FABRICADAS POR LA EMPRESA', '14', False),
        ('142005', 'Productos de reventa', '1420', True),
        ('1425', 'MATERIALES REPUESTOS Y ACCESORIOS', '14', False),
        ('142505', 'Materiales para la producción', '1425', True),
        ('142510', 'Repuestos', '1425', True),
        ('142515', 'Accesorios', '1425', True),
        ('15', 'PROPIEDADES PLANTA Y EQUIPO', '1', False),
        ('1504', 'TERRENOS', '15', False),
        ('150405', 'Urbanos', '1504', True),
        ('150410', 'Rurales', '1504', True),
        ('1506', 'MATERIALES PROYECTOS PETROLEROS', '15', False),
        ('150605', 'Pozos artesianos', '1506', True),
        ('1508', 'CONSTRUCCIONES EN CURSO', '15', False),
        ('150805', 'Construcciones y edificaciones', '1508', True),
        ('150810', 'Proyectos de ingeniería', '1508', True),
        ('1512', 'MAQUINARIA Y EQUIPO', '15', False),
        ('151205', 'Maquinaria y equipo', '1512', True),
        ('151210', 'Equipo de oficina', '1512', True),
        ('151215', 'Equipo de computación y comunicación', '1512', True),
        ('151220', 'Equipo médico científico', '1512', True),
        ('1516', 'EQUIPO DE TRANSPORTE', '15', False),
        ('151605', 'Aéreo', '1516', True),
        ('151610', 'Terrestre', '1516', True),
        ('1520', 'EQUIPO DE OFICINA', '15', False),
        ('152005', 'Muebles y enseres', '1520', True),
        ('152010', 'Equipo de oficina', '1520', True),
        ('1524', 'EQUIPO DE COMPUTACION Y COMUNICACION', '15', False),
        ('152405', 'Equipo de procesamiento de datos', '1524', True),
        ('152410', 'Equipo de telecomunicaciones', '1524', True),
        ('1528', 'CONSTRUCCIONES Y EDIFICACIONES', '15', False),
        ('152805', 'Construcciones y edificaciones', '1528', True),
        ('1532', 'ARMAMENTO DE VIGILANCIA', '15', False),
        ('153205', 'Armamento', '1532', True),
        ('1540', 'ENVASES Y EMPAQUES', '15', False),
        ('154005', 'Canastillas', '1540', True),
        ('154010', 'Envases', '1540', True),
        ('1592', 'DEPRECIACION ACUMULADA', '15', False),
        ('159205', 'Construcciones y edificaciones', '1592', True),
        ('159210', 'Maquinaria y equipo', '1592', True),
        ('16', 'INTANGIBLES', '1', False),
        ('1605', 'CREDITO MERCANTIL', '16', False),
        ('160505', 'Adquirido', '1605', True),
        ('1610', 'MARCAS', '16', False),
        ('161005', 'Adquiridas', '1610', True),
        ('1615', 'PATENTES', '16', False),
        ('161505', 'Adquiridas', '1615', True),
        ('1620', 'CONCESIONES Y FRANQUICIAS', '16', False),
        ('162005', 'Concesiones', '1620', True),
        ('162010', 'Franquicias', '1620', True),
        ('1625', 'DERECHOS', '16', False),
        ('162505', 'Derechos de autor', '1625', True),
        ('162510', 'Puesto de bolsa', '1625', True),
        ('162515', 'En fideicomisos inmobiliarios', '1625', True),
        ('1630', 'KNOW HOW', '16', False),
        ('163005', 'Técnico', '1630', True),
        ('163010', 'No técnico', '1630', True),
        ('1635', 'LICENCIAS', '16', False),
        ('163505', 'De fabricación', '1635', True),
        ('163510', 'De distribución', '1635', True),
        ('1698', 'AMORTIZACION ACUMULADA', '16', False),
        ('169805', 'Crédito mercantil', '1698', True),
        ('169810', 'Marcas', '1698', True),
        ('17', 'DIFERIDOS', '1', False),
        ('1705', 'GASTOS PAGADOS POR ANTICIPADO', '17', False),
        ('170505', 'Intereses', '1705', True),
        ('170510', 'Honorarios', '1705', True),
        ('170515', 'Comisiones', '1705', True),
        ('170520', 'Seguros y fianzas', '1705', True),
        ('170525', 'Arrendamientos', '1705', True),
        ('170530', 'Bodegajes', '1705', True),
        ('170535', 'Mantenimiento equipos', '1705', True),
        ('170540', 'Servicios', '1705', True),
        ('1710', 'CARGOS DIFERIDOS', '17', False),
        ('171004', 'Organización preoperativos', '1710', True),
        ('171008', 'Remodelaciones', '1710', True),
        ('171012', 'Estudios investigaciones y proyectos', '1710', True),
        ('171016', 'Programas para computador (software)', '1710', True),
        ('171020', 'Útiles y papelería', '1710', True),
        ('171024', 'Mejoras a propiedades ajenas', '1710', True),
        ('171028', 'Contribuciones y afiliaciones', '1710', True),
        ('171032', 'Entrenamiento de personal', '1710', True),
        ('171036', 'Publicidad', '1710', True),
        ('171040', 'Elementos de aseo y cafetería', '1710', True),
        ('171044', 'Moldes y troqueles', '1710', True),
        ('171048', 'Instrumental quirúrgico', '1710', True),
        ('18', 'OTROS ACTIVOS', '1', False),
        ('1805', 'BIENES DE ARTE Y CULTURA', '18', False),
        ('180505', 'Obras de arte', '1805', True),
        ('180510', 'Bibliotecas', '1805', True),
        ('1810', 'DIVERSOS', '18', False),
        ('181005', 'Monedas conmemorativas', '1810', True),
        ('181010', 'Joyas', '1810', True),
        ('19', 'VALORIZACIONES', '1', False),
        ('1905', 'DE INVERSIONES', '19', False),
        ('190505', 'Acciones', '1905', True),
        ('190510', 'Cuotas o partes de interés social', '1905', True),
        ('1910', 'DE PROPIEDADES PLANTA Y EQUIPO', '19', False),
        ('191005', 'Terrenos', '1910', True),
        ('191010', 'Construcciones y edificaciones', '1910', True),
        ('191015', 'Maquinaria y equipo', '1910', True),
        ('191020', 'Equipo de oficina', '1910', True),
        ('191025', 'Equipo de computación y comunicación', '1910', True),
        ('191030', 'Equipo médico científico', '1910', True),
        ('191035', 'Equipo de transporte', '1910', True),
        ('1915', 'DE OTROS ACTIVOS', '19', False),
        ('191505', 'Bienes de arte y cultura', '1915', True),
        ('191510', 'Diversos', '1915', True),
    ]
    
    # CLASE 2 - PASIVOS
    pasivos_accounts = [
        ('2', 'PASIVO', None, False),
        ('21', 'OBLIGACIONES FINANCIERAS', '2', False),
        ('2105', 'BANCOS NACIONALES', '21', False),
        ('210505', 'Sobregiros', '2105', True),
        ('210510', 'Pagarés', '2105', True),
        ('210515', 'Cartas de crédito', '2105', True),
        ('210520', 'Aceptaciones bancarias', '2105', True),
        ('210525', 'Préstamos simples', '2105', True),
        ('210530', 'Préstamos hipotecarios', '2105', True),
        ('2110', 'BANCOS DEL EXTERIOR', '21', False),
        ('211005', 'Sobregiros', '2110', True),
        ('211010', 'Cartas de crédito', '2110', True),
        ('211015', 'Préstamos simples', '2110', True),
        ('211020', 'Préstamos hipotecarios', '2110', True),
        ('2115', 'CORPORACIONES FINANCIERAS', '21', False),
        ('211505', 'Pagarés', '2115', True),
        ('211510', 'Aceptaciones financieras', '2115', True),
        ('211515', 'Préstamos simples', '2115', True),
        ('2120', 'COMPAÑIAS DE FINANCIAMIENTO COMERCIAL', '21', False),
        ('212005', 'Pagarés', '2120', True),
        ('212010', 'Aceptaciones financieras', '2120', True),
        ('212015', 'Préstamos simples', '2120', True),
        ('2125', 'CORPORACIONES DE AHORRO Y VIVIENDA', '21', False),
        ('212505', 'Contratos de ahorro programado', '2125', True),
        ('212510', 'Préstamos para vivienda', '2125', True),
        ('2130', 'ENTIDADES DE DESARROLLO ECONOMICO', '21', False),
        ('213005', 'Pagarés', '2130', True),
        ('213010', 'Préstamos simples', '2130', True),
        ('2135', 'COMPROMISOS DE RECOMPRA DE INVERSIONES NEGOCIADAS', '21', False),
        ('213505', 'Acciones', '2135', True),
        ('213510', 'Bonos', '2135', True),
        ('2140', 'COMPROMISOS DE RECOMPRA DE CARTERA NEGOCIADA', '21', False),
        ('214005', 'Vigente', '2140', True),
        ('2195', 'OTRAS OBLIGACIONES', '21', False),
        ('219505', 'Particulares', '2195', True),
        ('219510', 'Fundaciones', '2195', True),
        ('22', 'PROVEEDORES', '2', False),
        ('2205', 'NACIONALES', '22', False),
        ('220505', 'Casa matriz', '2205', True),
        ('220510', 'Compañías vinculadas', '2205', True),
        ('220515', 'Particulares', '2205', True),
        ('2210', 'DEL EXTERIOR', '22', False),
        ('221005', 'Casa matriz', '2210', True),
        ('221010', 'Compañías vinculadas', '2210', True),
        ('221015', 'Libre', '2210', True),
        ('2215', 'CUENTAS CORRIENTES COMERCIALES', '22', False),
        ('221505', 'Casa matriz', '2215', True),
        ('221510', 'Compañías vinculadas', '2215', True),
        ('221515', 'Particulares', '2215', True),
        ('23', 'CUENTAS POR PAGAR', '2', False),
        ('2305', 'CUENTAS CORRIENTES COMERCIALES', '23', False),
        ('230505', 'Casa matriz', '2305', True),
        ('230510', 'Compañías vinculadas', '2305', True),
        ('230515', 'Accionistas o socios', '2305', True),
        ('230520', 'Particulares', '2305', True),
        ('2310', 'A CASA MATRIZ', '23', False),
        ('231005', 'Compras', '2310', True),
        ('231010', 'Préstamos', '2310', True),
        ('231015', 'Dividendos y participaciones', '2310', True),
        ('231020', 'Servicios', '2310', True),
        ('231025', 'Honorarios', '2310', True),
        ('231030', 'Regalías', '2310', True),
        ('231035', 'Arrendamientos', '2310', True),
        ('2315', 'A COMPAÑIAS VINCULADAS', '23', False),
        ('231505', 'Filiales', '2315', True),
        ('231510', 'Subsidiarias', '2315', True),
        ('231515', 'Sucursales', '2315', True),
        ('2320', 'A CONTRATISTAS', '23', False),
        ('232005', 'Obras de construcción', '2320', True),
        ('232010', 'Urbanizaciones', '2320', True),
        ('2325', 'ORDENES DE COMPRA POR UTILIZAR', '23', False),
        ('232505', 'Proveedores nacionales', '2325', True),
        ('232510', 'Proveedores del exterior', '2325', True),
        ('2330', 'COSTOS Y GASTOS POR PAGAR', '23', False),
        ('233005', 'Gastos financieros', '2330', True),
        ('233010', 'Gastos legales', '2330', True),
        ('233015', 'Libros suscripciones periódicos y revistas', '2330', True),
        ('233020', 'Comisiones', '2330', True),
        ('233025', 'Honorarios', '2330', True),
        ('233030', 'Servicios técnicos', '2330', True),
        ('233035', 'Servicios de mantenimiento', '2330', True),
        ('233040', 'Arrendamientos', '2330', True),
        ('233045', 'Transportes fletes y acarreos', '2330', True),
        ('233050', 'Servicios públicos', '2330', True),
        ('233055', 'Propaganda y publicidad', '2330', True),
        ('233060', 'Servicios de aseo', '2330', True),
        ('233065', 'Servicios temporales', '2330', True),
        ('2335', 'DIVIDENDOS O PARTICIPACIONES POR PAGAR', '23', False),
        ('233505', 'Socios o accionistas', '2335', True),
        ('2340', 'RETENCIÓN EN LA FUENTE', '23', False),
        ('234005', 'Salarios y pagos laborales', '2340', True),
        ('234010', 'Dividendos y participaciones', '2340', True),
        ('234015', 'Honorarios', '2340', True),
        ('234020', 'Comisiones', '2340', True),
        ('234025', 'Servicios', '2340', True),
        ('234030', 'Arrendamientos', '2340', True),
        ('234035', 'Rendimientos financieros', '2340', True),
        ('234040', 'Compras', '2340', True),
        ('234045', 'Otros conceptos', '2340', True),
        ('2345', 'RETENCIÓN DE GARANTÍAS', '23', False),
        ('234505', 'Retenidas en contratos', '2345', True),
        ('2350', 'INSTALAMENTOS POR PAGAR', '23', False),
        ('235005', 'Maquinaria y equipo', '2350', True),
        ('235010', 'Equipo de oficina', '2350', True),
        ('235015', 'Equipo de computación y comunicación', '2350', True),
        ('235020', 'Equipo médico científico', '2350', True),
        ('235025', 'Equipo de hoteles y restaurantes', '2350', True),
        ('235030', 'Flota y equipo de transporte', '2350', True),
        ('235035', 'Flota y equipo fluvial y marítimo', '2350', True),
        ('235040', 'Construcciones y edificaciones', '2350', True),
        ('2355', 'ACREEDORES VARIOS', '23', False),
        ('235505', 'Depósitos recibidos', '2355', True),
        ('235510', 'Ingresos recibidos para terceros', '2355', True),
        ('235515', 'Préstamos de particulares', '2355', True),
        ('235520', 'Fondos de inversión', '2355', True),
        ('235525', 'Embargos judiciales', '2355', True),
        ('235530', 'Acreedores del sistema', '2355', True),
        ('24', 'IMPUESTOS GRAVAMENES Y TASAS', '2', False),
        ('2404', 'DE RENTA Y COMPLEMENTARIOS', '24', False),
        ('240405', 'Vigencia fiscal corriente', '2404', True),
        ('240410', 'Vigencias fiscales anteriores', '2404', True),
        ('2408', 'IMPUESTO SOBRE LAS VENTAS POR PAGAR', '24', False),
        ('240801', 'IVA generado', '2408', True),
        ('240805', 'IVA por pagar', '2408', True),
        ('2412', 'DE INDUSTRIA Y COMERCIO', '24', False),
        ('241205', 'Vigencia fiscal corriente', '2412', True),
        ('241210', 'Vigencias fiscales anteriores', '2412', True),
        ('2416', 'A LA PROPIEDAD RAÍZ', '24', False),
        ('241605', 'Vigencia fiscal corriente', '2416', True),
        ('241610', 'Vigencias fiscales anteriores', '2416', True),
        ('2420', 'DERECHOS SOBRE INSTRUMENTOS PUBLICOS', '24', False),
        ('242005', 'Registro de escrituras', '2420', True),
        ('242010', 'Registro mercantil', '2420', True),
        ('2424', 'DE VALORIZACIÓN', '24', False),
        ('242405', 'Vigencia fiscal corriente', '2424', True),
        ('242410', 'Vigencias fiscales anteriores', '2424', True),
        ('2428', 'DE TURISMO', '24', False),
        ('242805', 'Sobretasa bomberil', '2428', True),
        ('242810', 'Contribución turística', '2428', True),
        ('2432', 'TASA POR UTILIZACION DE PUERTOS', '24', False),
        ('243205', 'Puertos', '2432', True),
        ('2436', 'DE VEHICULOS', '24', False),
        ('243605', 'Automotor', '2436', True),
        ('2440', 'DE ESPECTACULOS PUBLICOS', '24', False),
        ('244005', 'Espectáculos públicos', '2440', True),
        ('2444', 'DE HIDROCARBUROS Y MINAS', '24', False),
        ('244405', 'De hidrocarburos', '2444', True),
        ('244410', 'De minas', '2444', True),
        ('2448', 'CUOTAS DE FOMENTO', '24', False),
        ('244805', 'Cuotas de fomento', '2448', True),
        ('2452', 'LICORES', '24', False),
        ('245205', 'Licores', '2452', True),
        ('2456', 'CERVEZAS', '24', False),
        ('245605', 'Cervezas', '2456', True),
        ('2460', 'CIGARRILLOS', '24', False),
        ('246005', 'Cigarrillos', '2460', True),
        ('2464', 'AL SACRIFICIO DE GANADO', '24', False),
        ('246405', 'Al sacrificio de ganado', '2464', True),
        ('2468', 'AL AZAR Y JUEGOS', '24', False),
        ('246805', 'Al azar y juegos', '2468', True),
        ('2472', 'RIFAS Y SORTEOS', '24', False),
        ('247205', 'Rifas y sorteos', '2472', True),
        ('2476', 'OTROS IMPUESTOS', '24', False),
        ('247605', 'Impuesto al patrimonio', '2476', True),
        ('247610', 'Otros', '2476', True),
        ('25', 'OBLIGACIONES LABORALES', '2', False),
        ('2505', 'SALARIOS POR PAGAR', '25', False),
        ('250505', 'Sueldos por pagar', '2505', True),
        ('250510', 'Jornales por pagar', '2505', True),
        ('250515', 'Prestaciones sociales', '2505', True),
        ('2510', 'CESANTÍAS CONSOLIDADAS', '25', False),
        ('251005', 'Ley laboral anterior', '2510', True),
        ('251010', 'Ley 50 de 1990', '2510', True),
        ('2515', 'INTERESES SOBRE CESANTÍAS', '25', False),
        ('251505', 'Ley laboral anterior', '2515', True),
        ('251510', 'Ley 50 de 1990', '2515', True),
        ('2520', 'PRIMA DE SERVICIOS', '25', False),
        ('252005', 'Prima de servicios', '2520', True),
        ('2525', 'VACACIONES CONSOLIDADAS', '25', False),
        ('252505', 'Vacaciones consolidadas', '2525', True),
        ('2530', 'PRESTACIONES EXTRALEGALES', '25', False),
        ('253005', 'Primas extralegales', '2530', True),
        ('253010', 'Auxilios', '2530', True),
        ('253015', 'Dotación y suministro a trabajadores', '2530', True),
        ('253020', 'Bonificaciones', '2530', True),
        ('253025', 'Seguros', '2530', True),
        ('253030', 'Planes complementarios de salud', '2530', True),
        ('2535', 'APORTES PARAFISCALES', '25', False),
        ('253505', 'SENA', '2535', True),
        ('253510', 'ICBF', '2535', True),
        ('253515', 'Cajas de compensación familiar', '2535', True),
        ('2540', 'APORTES AL SISTEMA GENERAL DE SEGURIDAD SOCIAL EN SALUD', '25', False),
        ('254005', 'EPS', '2540', True),
        ('2545', 'APORTES AL SISTEMA GENERAL DE PENSIONES', '25', False),
        ('254505', 'AFP - Administradora de fondos de pensiones', '2545', True),
        ('254510', 'ISS', '2545', True),
        ('2550', 'APORTES AL SISTEMA GENERAL DE RIESGOS PROFESIONALES', '25', False),
        ('255005', 'ARP', '2550', True),
        ('2555', 'EMBARGOS JUDICIALES', '25', False),
        ('255505', 'Cooperativas', '2555', True),
        ('255510', 'Libranzas', '2555', True),
        ('255515', 'Sindicatos', '2555', True),
        ('255520', 'Embargos judiciales', '2555', True),
        ('2560', 'CUOTAS SINDICALES', '25', False),
        ('256005', 'Cuotas sindicales', '2560', True),
        ('2565', 'LIBRANZAS', '25', False),
        ('256505', 'Libranzas', '2565', True),
        ('2570', 'FONDO DE EMPLEADOS', '25', False),
        ('257005', 'Fondo de empleados', '2570', True),
        ('2575', 'ADMINISTRADORAS DE RIESGOS LABORALES ARL', '25', False),
        ('257505', 'ARL', '2575', True),
        ('26', 'PASIVOS ESTIMADOS Y PROVISIONES', '2', False),
        ('2605', 'PARA COSTOS Y GASTOS', '26', False),
        ('260505', 'Intereses', '2605', True),
        ('260510', 'Comisiones', '2605', True),
        ('260515', 'Honorarios', '2605', True),
        ('260520', 'Servicios técnicos', '2605', True),
        ('260525', 'Servicios de mantenimiento', '2605', True),
        ('260530', 'Servicios públicos', '2605', True),
        ('260535', 'Reparaciones locativas', '2605', True),
        ('260540', 'Gastos de viaje', '2605', True),
        ('260545', 'Gastos de representación y relaciones públicas', '2605', True),
        ('2610', 'PARA OBLIGACIONES LABORALES', '26', False),
        ('261005', 'Cesantías', '2610', True),
        ('261010', 'Intereses sobre cesantías', '2610', True),
        ('261015', 'Vacaciones', '2610', True),
        ('261020', 'Prima de servicios', '2610', True),
        ('261025', 'Prestaciones extralegales', '2610', True),
        ('2615', 'PARA OBLIGACIONES FISCALES', '26', False),
        ('261505', 'De renta y complementarios', '2615', True),
        ('261510', 'De industria y comercio', '2615', True),
        ('261515', 'De derechos sobre instrumentos públicos', '2615', True),
        ('261595', 'Otros', '2615', True),
        ('2620', 'PENSIONES DE JUBILACIÓN', '26', False),
        ('262005', 'Pensiones de jubilación', '2620', True),
        ('2625', 'PARA TRABAJOS DE GARANTÍA', '26', False),
        ('262505', 'Reparaciones y mantenimiento', '2625', True),
        ('2630', 'PARA MULTAS SANCIONES Y LITIGIOS', '26', False),
        ('263005', 'Multas y sanciones', '2630', True),
        ('263010', 'Litigios', '2630', True),
        ('2635', 'PARA PRESTACIONES SOCIALES', '26', False),
        ('263505', 'Indemnizaciones laborales', '2635', True),
        ('2695', 'PROVISIONES DIVERSAS', '26', False),
        ('269505', 'Provisiones diversas', '2695', True),
        ('27', 'DIFERIDOS', '2', False),
        ('2705', 'INGRESOS RECIBIDOS POR ANTICIPADO', '27', False),
        ('270505', 'Intereses', '2705', True),
        ('270510', 'Comisiones', '2705', True),
        ('270515', 'Arrendamientos', '2705', True),
        ('270520', 'Honorarios', '2705', True),
        ('270525', 'Servicios técnicos', '2705', True),
        ('270530', 'Transportes fletes y acarreos', '2705', True),
        ('270535', 'Mercancías en tránsito ya vendidas', '2705', True),
        ('270540', 'Matriculas y pensiones', '2705', True),
        ('270545', 'Cuotas de administración', '2705', True),
        ('270550', 'Cuotas de sostenimiento', '2705', True),
        ('270595', 'Otros', '2705', True),
        ('2710', 'ABONOS DIFERIDOS', '27', False),
        ('271004', 'Reajuste del sistema', '2710', True),
        ('2715', 'UTILIDAD DIFERIDA EN VENTAS A PLAZOS', '27', False),
        ('271505', 'Utilidad diferida en ventas a plazos', '2715', True),
        ('2720', 'CREDITO POR CORRECCION MONETARIA DIFERIDA', '27', False),
        ('272005', 'Crédito por corrección monetaria diferida', '2720', True),
        ('2725', 'IMPUESTO DIFERIDO', '27', False),
        ('272505', 'Impuesto diferido', '2725', True),
        ('28', 'OTROS PASIVOS', '2', False),
        ('2805', 'ANTICIPOS Y AVANCES RECIBIDOS', '28', False),
        ('280505', 'De clientes', '2805', True),
        ('280510', 'Sobre contratos', '2805', True),
        ('2810', 'DEPOSITOS RECIBIDOS', '28', False),
        ('281005', 'Para futura suscripción de acciones', '2810', True),
        ('281010', 'De licitaciones', '2810', True),
        ('281015', 'Para importaciones', '2810', True),
        ('281020', 'De terceros', '2810', True),
        ('2815', 'INGRESOS RECIBIDOS PARA TERCEROS', '28', False),
        ('281505', 'Valores recibidos para terceros', '2815', True),
        ('2820', 'CUENTAS EN PARTICIPACIÓN', '28', False),
        ('282005', 'Agricultura ganadería caza y silvicultura', '2820', True),
        ('282010', 'Pesca', '2820', True),
        ('282015', 'Explotación de minas y canteras', '2820', True),
        ('282020', 'Industria manufacturera', '2820', True),
        ('282025', 'Suministro de electricidad gas y agua', '2820', True),
        ('282030', 'Construcción', '2820', True),
        ('282035', 'Comercio al por mayor y al por menor', '2820', True),
        ('282040', 'Hoteles y restaurantes', '2820', True),
        ('282045', 'Transporte almacenamiento y comunicaciones', '2820', True),
        ('282050', 'Actividad financiera', '2820', True),
        ('282055', 'Actividades inmobiliarias empresariales y de alquiler', '2820', True),
        ('282060', 'Enseñanza', '2820', True),
        ('282065', 'Servicios sociales y de salud', '2820', True),
        ('282070', 'Otras actividades de servicios comunitarios', '2820', True),
        ('2825', 'EMBARGOS JUDICIALES', '28', False),
        ('282505', 'Cuentas corrientes', '2825', True),
        ('282510', 'Bancos nacionales', '2825', True),
        ('282515', 'Ahorros', '2825', True),
        ('282520', 'Fiduciaria', '2825', True),
        ('282525', 'De inversiones', '2825', True),
        ('2830', 'ACREEDORES DEL SISTEMA', '28', False),
        ('283005', 'Cuotas netas', '2830', True),
        ('283010', 'Intereses', '2830', True),
        ('283015', 'Cuotas de administración', '2830', True),
        ('283020', 'Seguros', '2830', True),
        ('283025', 'Cuotas extraordinarias', '2830', True),
        ('2895', 'OTROS', '28', False),
        ('289505', 'Diversos', '2895', True),
        ('29', 'BONOS Y PAPELES COMERCIALES', '2', False),
        ('2905', 'BONOS EN CIRCULACIÓN', '29', False),
        ('290505', 'Bonos ordinarios', '2905', True),
        ('290510', 'Bonos convertibles en acciones', '2905', True),
        ('2910', 'BONOS OBLIGATORIAMENTE CONVERTIBLES EN ACCIONES', '29', False),
        ('291005', 'Bonos obligatoriamente convertibles en acciones', '2910', True),
        ('2915', 'PAPELES COMERCIALES', '29', False),
        ('291505', 'Empresas comerciales', '2915', True),
        ('291510', 'Empresas industriales', '2915', True),
        ('291515', 'Empresas de servicios', '2915', True),
        ('2920', 'BONOS PENSIONALES', '29', False),
        ('292005', 'Bonos pensionales', '2920', True),
        ('2925', 'TITULARIZACIONES', '29', False),
        ('292505', 'Titularizaciones', '2925', True),
        ('2995', 'OTROS TITULOS DE DEUDA', '29', False),
        ('299505', 'Otros títulos de deuda', '2995', True),
    ]
    
    # CLASE 3 - PATRIMONIO
    patrimonio_accounts = [
        ('3', 'PATRIMONIO', None, False),
        ('31', 'CAPITAL SOCIAL', '3', False),
        ('3105', 'CAPITAL SUSCRITO Y PAGADO', '31', False),
        ('310505', 'Capital autorizado', '3105', True),
        ('310510', 'Capital por suscribir', '3105', True),
        ('310515', 'Capital suscrito', '3105', True),
        ('310520', 'Capital asignado', '3105', True),
        ('3110', 'APORTES SOCIALES', '31', False),
        ('311005', 'Cuotas o partes de interés social', '3110', True),
        ('311010', 'Aportes de socios', '3110', True),
        ('3115', 'CAPITAL DE PERSONAS NATURALES', '31', False),
        ('311505', 'Capital de personas naturales', '3115', True),
        ('3120', 'APORTES DEL ESTADO', '31', False),
        ('312005', 'Aportes del Estado', '3120', True),
        ('3125', 'INVERSIÓN SUPLEMENTARIA AL CAPITAL ASIGNADO', '31', False),
        ('312505', 'Inversión suplementaria al capital asignado', '3125', True),
        ('32', 'SUPERAVIT DE CAPITAL', '3', False),
        ('3205', 'PRIMA EN COLOCACION DE ACCIONES CUOTAS O PARTES DE INTERES SOCIAL', '32', False),
        ('320505', 'Prima en colocación de acciones', '3205', True),
        ('320510', 'Prima en colocación de cuotas o partes de interés social', '3205', True),
        ('3210', 'DONACIONES', '32', False),
        ('321005', 'En dinero', '3210', True),
        ('321010', 'En valores mobiliarios', '3210', True),
        ('321015', 'En bienes muebles', '3210', True),
        ('321020', 'En bienes inmuebles', '3210', True),
        ('321025', 'En intangibles', '3210', True),
        ('3215', 'CREDITO MERCANTIL', '32', False),
        ('321505', 'Crédito mercantil', '3215', True),
        ('3220', 'KNOW HOW', '32', False),
        ('322005', 'Know how', '3220', True),
        ('3225', 'SUPERAVIT METODO DE PARTICIPACION', '32', False),
        ('322505', 'De acciones', '3225', True),
        ('322510', 'De cuotas o partes de interés social', '3225', True),
        ('33', 'RESERVAS', '3', False),
        ('3305', 'RESERVAS OBLIGATORIAS', '33', False),
        ('330505', 'Reserva legal', '3305', True),
        ('330510', 'Reservas estatutarias', '3305', True),
        ('330515', 'Reservas ocasionales', '3305', True),
        ('3310', 'RESERVAS OCASIONALES', '33', False),
        ('331005', 'Para futuras capitalizaciones', '3310', True),
        ('331010', 'Para reposición de activos', '3310', True),
        ('331015', 'Para futuros ensanches', '3310', True),
        ('331020', 'Para adquisición o reposición de acciones propias', '3310', True),
        ('331025', 'Para capital de trabajo', '3310', True),
        ('331030', 'Para estabilización de rendimientos', '3310', True),
        ('331095', 'Otras', '3310', True),
        ('34', 'REVALORIZACION DEL PATRIMONIO', '3', False),
        ('3405', 'AJUSTES POR INFLACIÓN', '34', False),
        ('340505', 'De capital social', '3405', True),
        ('340510', 'De superávit de capital', '3405', True),
        ('340515', 'De reservas', '3405', True),
        ('340520', 'De resultados de ejercicios anteriores', '3405', True),
        ('340525', 'De otras cuentas del patrimonio', '3405', True),
        ('3410', 'SANEAMIENTO FISCAL', '34', False),
        ('341005', 'De activos', '3410', True),
        ('341010', 'De pasivos', '3410', True),
        ('341015', 'Del patrimonio', '3410', True),
        ('3415', 'AJUSTES POR CONVERSIÒN', '34', False),
        ('341505', 'De inversiones permanentes en sociedades extranjeras', '3415', True),
        ('35', 'DIVIDENDOS O PARTICIPACIONES DECRETADOS EN ACCIONES CUOTAS O PARTES DE INTERES SOCIAL', '3', False),
        ('3505', 'DIVIDENDOS DECRETADOS EN ACCIONES', '35', False),
        ('350505', 'Dividendos decretados en acciones', '3505', True),
        ('3510', 'PARTICIPACIONES DECRETADAS EN CUOTAS O PARTES DE INTERES SOCIAL', '35', False),
        ('351005', 'Participaciones decretadas en cuotas', '3510', True),
        ('36', 'RESULTADOS DEL EJERCICIO', '3', False),
        ('3605', 'UTILIDAD DEL EJERCICIO', '36', False),
        ('360505', 'Utilidad del ejercicio', '3605', True),
        ('3610', 'PÉRDIDA DEL EJERCICIO', '36', False),
        ('361005', 'Pérdida del ejercicio', '3610', True),
        ('37', 'RESULTADOS DE EJERCICIOS ANTERIORES', '3', False),
        ('3705', 'UTILIDADES ACUMULADAS', '37', False),
        ('370505', 'Utilidades acumuladas', '3705', True),
        ('3710', 'PERDIDAS ACUMULADAS', '37', False),
        ('371005', 'Pérdidas acumuladas', '3710', True),
        ('38', 'SUPERAVIT POR VALORIZACIONES', '3', False),
        ('3805', 'DE INVERSIONES', '38', False),
        ('380505', 'Acciones', '3805', True),
        ('380510', 'Cuotas o partes de interés social', '3805', True),
        ('380515', 'Bonos', '3805', True),
        ('380520', 'Cédulas', '3805', True),
        ('380525', 'Certificados', '3805', True),
        ('380530', 'Papeles comerciales', '3805', True),
        ('380535', 'Aceptaciones financieras', '3805', True),
        ('380540', 'Derechos fiduciarios', '3805', True),
        ('380545', 'Obligatorias', '3805', True),
        ('380550', 'Cuentas en participación', '3805', True),
        ('380595', 'Otras inversiones', '3805', True),
        ('3810', 'DE PROPIEDADES PLANTA Y EQUIPO', '38', False),
        ('381005', 'Terrenos', '3810', True),
        ('381010', 'Construcciones y edificaciones', '3810', True),
        ('381015', 'Maquinaria y equipo', '3810', True),
        ('381020', 'Equipo de oficina', '3810', True),
        ('381025', 'Equipo de computación y comunicación', '3810', True),
        ('381030', 'Equipo médico científico', '3810', True),
        ('381035', 'Equipo de hoteles y restaurantes', '3810', True),
        ('381040', 'Flota y equipo de transporte', '3810', True),
        ('381045', 'Flota y equipo fluvial y marítimo', '3810', True),
        ('381050', 'Acueductos plantas y redes', '3810', True),
        ('381055', 'Armamento de vigilancia', '3810', True),
        ('381060', 'Envases y empaques', '3810', True),
        ('381065', 'Plantaciones agrícolas y forestales', '3810', True),
        ('381070', 'Vías de comunicación', '3810', True),
        ('381075', 'Minas y canteras', '3810', True),
        ('381080', 'Pozos artesianos', '3810', True),
        ('381085', 'Yacimientos', '3810', True),
        ('381090', 'Semovientes', '3810', True),
        ('381095', 'Propiedades planta y equipo en tránsito', '3810', True),
        ('3815', 'DE OTROS ACTIVOS', '38', False),
        ('381505', 'Bienes de arte y cultura', '3815', True),
        ('381510', 'Diversos', '3815', True),
        ('39', 'PATRIMONIO INSTITUCIONAL', '3', False),
        ('3905', 'PATRIMONIO INSTITUCIONAL', '39', False),
        ('390505', 'Patrimonio público', '3905', True),
        ('390510', 'Patrimonio institucional', '3905', True),
        ('3910', 'PATRIMONIO DE ORGANIZACIONES POPULARES DE VIVIENDA', '39', False),
        ('391005', 'Patrimonio de organizaciones populares de vivienda', '3910', True),
    ]
    
    # Todas las cuentas completas
    all_accounts = activos_accounts + pasivos_accounts + patrimonio_accounts
    
    created_count = 0
    for code, name, parent_code, is_detail in all_accounts:
        # Determinar tipo de cuenta basado en el primer dígito
        first_digit = code[0]
        account_type = account_types.get(first_digit)
        
        if not account_type:
            continue
        
        # Buscar cuenta padre
        parent = None
        if parent_code:
            parent = Account.objects.filter(
                chart_of_accounts=chart, 
                code=parent_code
            ).first()
        
        # Determinar el nivel
        level = len(code)
        if level == 1:
            level = 1  # Clase
        elif level == 2:
            level = 2  # Grupo
        elif level == 4:
            level = 3  # Cuenta
        elif level == 6:
            level = 4  # Subcuenta
        else:
            level = 4  # Por defecto
        
        # Crear cuenta si no existe
        account, created = Account.objects.get_or_create(
            chart_of_accounts=chart,
            code=code,
            defaults={
                'name': name,
                'account_type': account_type,
                'parent': parent,
                'level': level,
                'is_detail': is_detail,
                'is_active': True,
                'description': f'Cuenta {name} del PUC colombiano según Decreto 2650/93',
                'created_by': admin_user
            }
        )
        
        if created:
            created_count += 1
    
    print(f'   [+] Se crearon {created_count} nuevas cuentas para {chart.company.name}')

if __name__ == '__main__':
    print('[*] Iniciando creacion del PUC completo de Colombia...')
    create_complete_puc()
    print('[OK] PUC completo implementado exitosamente!')